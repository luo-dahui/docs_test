<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>WASM智能合约 · PlatON</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="PlatON区块链支持使用WebAssembly (WASM)来执行用户编写的智能合约，WASM是一种为栈式虚拟机设计的二进制指令集。WASM被设计为可供类似C/C++/Rust等高级语言的平台编译目标，最初设计目的是解决 JavaScript 的性能问题。WASM是由 W3C 牵头正在推进的 Web 标准，并得到了谷歌、微软和 Mozilla 等浏览器厂商的支持。"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="WASM智能合约 · PlatON"/><meta property="og:type" content="website"/><meta property="og:url" content="https://luo-dahui.github.io//docs/"/><meta property="og:description" content="PlatON区块链支持使用WebAssembly (WASM)来执行用户编写的智能合约，WASM是一种为栈式虚拟机设计的二进制指令集。WASM被设计为可供类似C/C++/Rust等高级语言的平台编译目标，最初设计目的是解决 JavaScript 的性能问题。WASM是由 W3C 牵头正在推进的 Web 标准，并得到了谷歌、微软和 Mozilla 等浏览器厂商的支持。"/><meta property="og:image" content="https://luo-dahui.github.io//docs/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://luo-dahui.github.io//docs/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/docs/img/logo.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@8.4.0/dist/mermaid.min.js"></script><script type="text/javascript" src="/docs/js/custom.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.platon.network/?lang=zh"><img class="logo" src="/docs/img/PlatON-logo.svg" alt="PlatON"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/WASM_Smart_Contract">English</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>智能合约</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">PlatON开发者文档<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/">PlatON开发者文档</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">PlatON基础<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/PlatON_Overall_Solution">PlatON总体方案</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Economic_Model">PlatON经济方案</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/PlatON_Solution">PlatON共识方案</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/PlatON_Governance_Solution">PlatON治理方案</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Secure_Multi_Party_Computation">安全多方计算</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Verifiable_Computation">可验证计算</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">PlatON节点<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/PlatON_Validation_Introduce">PlatON验证节点介绍</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Network_Description">网络说明</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">test</h4><ul><li class="navListItem"><a class="navItem" href="/docs/zh-CN/test1">my_test1</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/test2">my_test2</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">节点工具<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/OnLine_MTool_Manual">在线PlatON MTool教程</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/OffLine_MTool_Manual">离线PlatON MTool教程</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Command_Line_Tools">PlatON命令行工具</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">智能合约<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/EVM_Smart_Contract">EVM智能合约</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/zh-CN/WASM_Smart_Contract">WASM智能合约</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API参考<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Python_SDK">Python SDK</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Java_SDK">Java SDK</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/JS_SDK">JS SDK</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/Json_Rpc">JSON RPC</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">数据分析<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/PlatON_BlockChain_Browser">区块链浏览器介绍</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">钱包<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/ATON-user-manual">ATON钱包用户使用手册</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">社区<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/community">社区项目</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">WASM智能合约</h1></header><article><div><span><p>PlatON区块链支持使用WebAssembly (WASM)来执行用户编写的智能合约，WASM是一种为栈式虚拟机设计的二进制指令集。WASM被设计为可供类似C/C++/Rust等高级语言的平台编译目标，最初设计目的是解决 JavaScript 的性能问题。WASM是由 W3C 牵头正在推进的 Web 标准，并得到了谷歌、微软和 Mozilla 等浏览器厂商的支持。</p>
<p>开发高性能和安全的智能合约，C++是最好的语言。PlatON WASM合约支持C++编写，同时在目前最为成熟的编译工具链clang/llvm的C/C++编译器基础上定制一个符合PlatON协议标准的编译器，本开发指南是从开发者角度介绍智能合约的开发流程和开发过程中需要注意的常见问题，引导开发者可以使用C++在PlatON网络快速开发出高质量的智能合约。</p>
<p>主要从以下几个方面进行讲解：</p>
<ul>
<li><a href="#入门">入门</a></li>
<li><a href="#合约开发成本">合约开发成本</a></li>
<li><a href="#最佳实践">最佳实践</a></li>
<li><a href="#api">API</a></li>
<li><a href="#faq">FAQ</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="入门"></a><a href="#入门" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>入门</h2>
<h3><a class="anchor" aria-hidden="true" id="概要"></a><a href="#概要" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>概要</h3>
<p>本教程主要是指导用户在PlatON上使用wasm语言创建简单的HelloWorld智能合约，通过platon-truffle编译，部署，调用此合约。</p>
<h3><a class="anchor" aria-hidden="true" id="platon-truffle开发工具介绍"></a><a href="#platon-truffle开发工具介绍" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon-truffle开发工具介绍</h3>
<p>platon-truffle是PlatON提供的一款能够在本地编译、部署、调用智能合约的工具，具体的安装及使用手册参见</p>
<ul>
<li>platon-truffle开发工具<a href="https://platon-truffle.readthedocs.io/en/v0.13.1/getting-started/installation.html">安装参考</a></li>
<li>platon-truffle开发工具<a href="https://platon-truffle.readthedocs.io/en/v0.13.1/">使用手册</a></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="创建helloworld合约"></a><a href="#创建helloworld合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建HelloWorld合约</h3>
<pre><code class="hljs css language-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;platon/platon.hpp&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> platon;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span> {</span>
   <span class="hljs-keyword">public</span>:
      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> head;
      PLATON_SERIALIZE(message, (head))
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">my_message</span> :</span> <span class="hljs-keyword">public</span> message {
   <span class="hljs-keyword">public</span>:
      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> body;
      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-built_in">end</span>;
      PLATON_SERIALIZE_DERIVED(my_message, message, (body)(<span class="hljs-built_in">end</span>))
};

CONTRACT HelloWorld : <span class="hljs-keyword">public</span> platon::Contract{
   <span class="hljs-keyword">public</span>:
      <span class="hljs-function">ACTION <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">const</span> my_message &amp;one_message)</span></span>{
        info.self().push_back(one_message);
      }

      <span class="hljs-function">ACTION <span class="hljs-keyword">void</span> <span class="hljs-title">add_message</span><span class="hljs-params">(<span class="hljs-keyword">const</span> my_message &amp;one_message)</span></span>{
          info.self().push_back(one_message);
      }

      <span class="hljs-function">CONST <span class="hljs-keyword">uint8_t</span> <span class="hljs-title">get_message_size</span><span class="hljs-params">()</span></span>{
          <span class="hljs-keyword">return</span> info.self().<span class="hljs-built_in">size</span>();
      }

      <span class="hljs-function">CONST <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">get_message_body</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> index)</span></span>{
          <span class="hljs-keyword">return</span> info.self()[index].body;
      }

   <span class="hljs-keyword">private</span>:
      platon::StorageType&lt;<span class="hljs-string">"myvector"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;my_message&gt;&gt; info;
};

PLATON_DISPATCH(HelloWorld, (init)(add_message)(get_message_size)(get_message_body))

</code></pre>
<p>合约文件说明</p>
<ul>
<li><p>每一个合约文件只有一个合约类，合约类用 CONTRACT 修饰, 必须公有继承 platon::Contract，必须要有 init 函数。</p></li>
<li><p>ACTION 和 CONST 修饰的成员函数表示可调用函数，此类成员函数不可以重载。ACTION 函数会修改链上数据，CONST 函数只是查询属性不会修改链上数据。</p></li>
<li><p>可调用函数参数列表中的类型为自定义类型，此类型定义中需加上 PLATON_SERIALIZE 宏声明序列化函数，此类型继承自其他类型，需加上 PLATON_SERIALIZE_DERIVED 宏声明序列化函数。</p></li>
<li><p>可调用函数只有在PLATON_DISPATCH 宏定义统一入口函数，才能够被外部调用。</p></li>
<li><p>目前 platon 会将合约类的成员变量持久化存储，成员变量必须是 platon::StorageType 类型，platon::StorageType模板的第一个参数字符串后面加上_n，字符串必须为.12345abcdefghijklmnopqrstuvwxyz这32字符中的字符。第二个参数为实际存储的具体类型。成员函数修改成员变量需要通过 self() 函数获取具体类型的实例，然后执行相应的实例函数。</p></li>
<li><p>platon::StorageType 模板的第二个参数类型为自定义类型，此类型定义中需加上 PLATON_SERIALIZE 宏声明序列化函数，此类型继承自其他类型，需加上 PLATON_SERIALIZE_DERIVED 宏声明序列化函数。</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="编译helloworld合约"></a><a href="#编译helloworld合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>编译HelloWorld合约</h3>
<p><strong>step1.</strong> 为HelloWorld项目创建新目录</p>
<pre><code class="hljs"><span class="hljs-built_in">mkdir</span> HelloWorld &amp;&amp; <span class="hljs-built_in">cd</span> HelloWorld
</code></pre>
<ul>
<li>以下命令如果没有特殊说明都在HelloWorld目录下进行</li>
</ul>
<p><strong>step2.</strong> 使用platon-truffle初始化一个工程</p>
<pre><code class="hljs"><span class="hljs-attribute">platon-truffle init</span>
</code></pre>
<p>在操作完成之后，就有如下项目结构：</p>
<ul>
<li><p>contracts/: wasm合约目录</p></li>
<li><p>migrations/: 部署脚本文件目录</p></li>
<li><p>test/: 测试脚本目录</p></li>
<li><p>truffle-config.js: platon-truffle 配置文件</p></li>
</ul>
<p><strong>step3.</strong> 将之前编写好的HelloWorld合约放至HelloWorld/contracts/目录下</p>
<pre><code class="hljs"><span class="hljs-keyword">ls</span> contracts/
</code></pre>
<ul>
<li>将看到HelloWorld.cpp</li>
</ul>
<p><strong>step4.</strong> 修改platon-truffle 配置文件truffle-config.js，添加编译wasm合约版本号</p>
<pre><code class="hljs">vim truffle-<span class="hljs-built_in">config</span>.<span class="hljs-keyword">js
</span></code></pre>
<p>truffle-config.js 修改部分内容如下：</p>
<pre><code class="hljs"><span class="hljs-selector-tag">compilers</span>: {
     <span class="hljs-attribute">wasm</span>: {
           version: <span class="hljs-string">"1.0.0"</span>
     }
}
</code></pre>
<p><strong>step5.</strong> 编译合约</p>
<pre><code class="hljs"><span class="hljs-attribute">platon-truffle compile</span>
</code></pre>
<p>在操作完成之后，生成如下目录结构：</p>
<ul>
<li><code>build/</code> wasm合约编译后的目录</li>
<li><code>build/contracts/HelloWorld.abi.json</code>  HelloWorld合约编译后的abi接口文件</li>
<li><code>build/contracts/HelloWorld.wasm</code>  HelloWorld合约编译后的二进制文件</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="部署helloworld合约"></a><a href="#部署helloworld合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>部署HelloWorld合约</h3>
<p><strong>step1.</strong> 修改truffle-config.js中链的配置信息</p>
<pre><code class="hljs">vim truffle-<span class="hljs-built_in">config</span>.<span class="hljs-keyword">js
</span></code></pre>
<p>将truffle-config.js中的区块链相关配置修改成您真实连接的链配置</p>
<pre><code class="hljs"><span class="hljs-symbol">networks:</span> {
<span class="hljs-symbol">    development:</span> {
<span class="hljs-symbol">       host:</span> <span class="hljs-string">"10.1.1.6"</span>,     <span class="hljs-comment">// 区块链所在服务器主机</span>
<span class="hljs-symbol">       port:</span> <span class="hljs-number">8806</span>,            <span class="hljs-comment">// 链端口号</span>
<span class="hljs-symbol">       network_id:</span> <span class="hljs-string">"*"</span>,       <span class="hljs-comment">// Any network (default: none)</span>
<span class="hljs-symbol">       from:</span> <span class="hljs-string">"lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl"</span>,
<span class="hljs-symbol">       gas:</span> <span class="hljs-number">999999</span>,
<span class="hljs-symbol">       gasPrice:</span> <span class="hljs-number">50000000004</span>,
    },
}
</code></pre>
<p><strong>step2.</strong>  解锁钱包账户</p>
<p>进入platon-truffle控制台</p>
<pre><code class="hljs">platon-truffle<span class="hljs-built_in"> console
</span></code></pre>
<p>导入私钥（如果之前已导入可以跳过此步骤）</p>
<pre><code class="hljs"><span class="hljs-selector-tag">web3</span><span class="hljs-selector-class">.platon</span><span class="hljs-selector-class">.personal</span><span class="hljs-selector-class">.importRawKey</span>("您的钱包私钥","您的钱包密码");
</code></pre>
<p>导入成功将看到私钥对应的地址：</p>
<pre><code class="hljs"><span class="hljs-symbol">'lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl</span>'
</code></pre>
<p>解锁钱包账户</p>
<pre><code class="hljs"> <span class="hljs-selector-tag">web3</span><span class="hljs-selector-class">.platon</span><span class="hljs-selector-class">.personal</span><span class="hljs-selector-class">.unlockAccount</span>(<span class="hljs-string">'您的钱包地址'</span>,<span class="hljs-string">'您的钱包密码'</span>,<span class="hljs-number">999999</span>);
</code></pre>
<p>解锁成功将看到如下信息：</p>
<pre><code class="hljs"><span class="hljs-attribute">ture</span>
</code></pre>
<p><strong>step3.</strong> 部署HelloWorld合约</p>
<pre><code class="hljs">platon-truffle <span class="hljs-keyword">deploy</span> <span class="hljs-params">--wasm</span> <span class="hljs-params">--contract-name</span> HelloWorld <span class="hljs-params">--params</span> '[[[<span class="hljs-string">"1"</span>], <span class="hljs-string">"2"</span>, <span class="hljs-string">"3"</span>]]'
</code></pre>
<ul>
<li><code>HelloWorld</code> :要部署的合约</li>
<li><code>params</code> :合约init函数对应的参数</li>
</ul>
<p>部署成功后，将看到类似如下信息：</p>
<pre><code class="hljs">receipt:  { blockHash:
   '0x<span class="hljs-number">266733</span>b693ba<span class="hljs-number">650315</span>a59c34e<span class="hljs-number">7280</span>4c06ca3e27fab<span class="hljs-number">14562579</span>7bd<span class="hljs-number">4225</span>9b572c5',
  blockNumber: <span class="hljs-number">70441</span>,
  contractAddress: 'lax1p<span class="hljs-number">0698</span>y95s6ysfphxavl36hywppq0mz6ks673np',
  cumulativeGasUsed: <span class="hljs-number">291314</span>,
  from: 'lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl',
  gasUsed: <span class="hljs-number">291314</span>,
  logs: [],
  logsBloom:
   '0x<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000</span>',
  status: true,
  to: <span class="hljs-literal">null</span>,
  transactionHash:
   '0x<span class="hljs-number">6094</span>6ebf0ccddc76a<span class="hljs-number">0234353435</span>de73e<span class="hljs-number">7901888227</span>fb2f<span class="hljs-number">0392</span>2fb0ce265a4e9d',
  transactionIndex: <span class="hljs-number">0</span> }
  contract HelloWorld deployed successfully
======================

   &gt; transactionHash:     <span class="hljs-number">0</span>x60946ebf0ccddc76a0234353435de73e7901888227fb2f03922fb0ce265a4e9d
   &gt; contract address:    lax1p0698y95s6ysfphxavl36hywppq0mz6ks673np
   &gt; block number:        <span class="hljs-number">70441</span>
   &gt; block timestamp:     <span class="hljs-number">1583247148341</span>
   &gt; account:             lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl
   &gt; balance:             <span class="hljs-number">3533694129556768659166595001485837031654967793751237866225582808584074296</span>
   &gt; gas limit:           <span class="hljs-number">100000000</span>
   &gt; gas used:            <span class="hljs-number">291314</span>
   &gt; gas price:           <span class="hljs-number">0.000000050000000004</span> LAT
   &gt; total cost:          <span class="hljs-number">0.014565700001165256</span> LAT
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="调用helloworld合约"></a><a href="#调用helloworld合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>调用HelloWorld合约</h3>
<p><strong>step1.</strong>  进入platon-truffle控制台</p>
<pre><code class="hljs">platon-truffle<span class="hljs-built_in"> console
</span></code></pre>
<ul>
<li>以下调用查询将在platon-truffle控制台中进行</li>
</ul>
<p><strong>step2.</strong>  构建合约对象</p>
<pre><code class="hljs css language-json">var abi = [{"baseclass":[],"fields":[{"name":"head","type":"string"}],"name":"message","type":"struct"},{"baseclass":["message"],"fields":[{"name":"body","type":"string"},{"name":"end","type":"string"}],"name":"my_message","type":"struct"},{"constant":false,"input":[{"name":"one_message","type":"my_message"}],"name":"init","output":"void","type":"Action"},{"constant":false,"input":[{"name":"one_message","type":"my_message"}],"name":"add_message","output":"void","type":"Action"},{"constant":true,"input":[],"name":"get_message_size","output":"uint8","type":"Action"},{"constant":true,"input":[{"name":"index","type":"uint8"}],"name":"get_message_body","output":"string","type":"Action"}];
var contractAddr = 'lax1p0698y95s6ysfphxavl36hywppq0mz6ks673np';
 
var helloworld = new web3.platon.Contract(abi,contractAddr,{vmType: 1 }); 
</code></pre>
<p>说明：</p>
<ul>
<li><code>abi</code> 是合约提供给外部调用时的接口，每个合约对应的abi在编译后的文件中，如：<code>HelloWorld/build/contracts/HelloWorld.json</code> 中可以找到</li>
<li><code>contractAddr</code> 在部署合约成功后有一个contract address</li>
<li><code>helloWorld</code> 就是构建出来与链上合约交互的合约对象抽象</li>
</ul>
<p><strong>step3.</strong>  调用合约</p>
<pre><code class="hljs css language-javascript">helloworld.methods.add_message([[<span class="hljs-string">"5"</span>], <span class="hljs-string">"6"</span>, <span class="hljs-string">"7"</span>]).send({
    <span class="hljs-attr">from</span>: <span class="hljs-string">'lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl'</span>,<span class="hljs-attr">gas</span>: <span class="hljs-number">999999</span>
}).on(<span class="hljs-string">'receipt'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">receipt</span>) </span>{
    <span class="hljs-built_in">console</span>.log(receipt);
}).on(<span class="hljs-string">'error'</span>, <span class="hljs-built_in">console</span>.error);
</code></pre>
<p>调用合约命令说明：</p>
<ul>
<li><code>helloWorld</code> 是之前构建的合约对象</li>
<li><code>methods</code> 固定语法,后面紧跟合约的方法名</li>
<li><code>add_message</code> 是我们HelloWorld合约中的一个方法，有一个自定义my_message类型的入参</li>
<li><code>from</code> 调用者的钱包地址</li>
<li><code>gas</code> gas值</li>
<li><code>on</code> 是监听合约处理结果事件，此处如果成功将打印回执，失败输出错误日志</li>
</ul>
<p>函数调用成功，将会看到如下信息：</p>
<pre><code class="hljs">{ blockHash:
   '0x669c7b8cb938cc<span class="hljs-number">3084</span>5e08dc4ceda08f2e<span class="hljs-number">1720</span>7c267ade97dc<span class="hljs-number">5458</span>b<span class="hljs-number">44540573</span>6',
  blockNumber: <span class="hljs-number">74665</span>,
  contractAddress: <span class="hljs-literal">null</span>,
  cumulativeGasUsed: <span class="hljs-number">108549</span>,
  from: 'lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl',
  gasUsed: <span class="hljs-number">108549</span>,
  logsBloom:
   '0x<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000</span>',
  status: true,
  to: 'lax1p<span class="hljs-number">0698</span>y95s6ysfphxavl36hywppq0mz6ks673np',
  transactionHash:
   '0x2b5e590df7e70ad428b1ccb06bda5dcce47f84c4d981c2fb475aca9ec9d<span class="hljs-number">0000</span>a',
  transactionIndex: <span class="hljs-number">0</span>,
  events: {} }
{ blockHash:
   '0x669c7b8cb938cc<span class="hljs-number">3084</span>5e08dc4ceda08f2e<span class="hljs-number">1720</span>7c267ade97dc<span class="hljs-number">5458</span>b<span class="hljs-number">44540573</span>6',
  blockNumber: <span class="hljs-number">74665</span>,
  contractAddress: <span class="hljs-literal">null</span>,
  cumulativeGasUsed: <span class="hljs-number">108549</span>,
  from: 'lax1uqug0zq7rcxddndleq4ux2ft3tv6dqljphydrl',
  gasUsed: <span class="hljs-number">108549</span>,
  logsBloom:
   '0x<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000</span>',
  status: true,
  to: 'lax1p<span class="hljs-number">0698</span>y95s6ysfphxavl36hywppq0mz6ks673np',
  transactionHash:
   '0x2b5e590df7e70ad428b1ccb06bda5dcce47f84c4d981c2fb475aca9ec9d<span class="hljs-number">0000</span>a',
  transactionIndex: <span class="hljs-number">0</span>,
  events: {} }
</code></pre>
<p><strong>step4.</strong>  合约查询</p>
<pre><code class="hljs css language-javascript">helloworld.methods.get_message_body(<span class="hljs-number">0</span>).call()
</code></pre>
<p>查询合约命令说明：</p>
<ul>
<li><code>helloWorld</code> 是之前构建的合约对象</li>
<li><code>methods</code> 指定将获取合约中的方法</li>
<li><code>get_message_body</code> 是我们HelloWorld合约中的一个方法，该方法有一个int类型的入参</li>
<li><code>call</code> 指明是查询方法</li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="合约开发成本"></a><a href="#合约开发成本" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合约开发成本</h2>
<h3><a class="anchor" aria-hidden="true" id="概要-1"></a><a href="#概要-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>概要</h3>
<p>在区块链系统中，基于任何一条公链系统开发智能合约都涉及资源支出的开发成本。例如，在网络上部署/调用智能合约，进行能量转移，质押/委托等操作都需要花费一定的成本，不同的区块链网络开发成本不一样，在 <code>PlatON</code> 网络中运行着两种虚拟机EVM和WASM，在不同虚拟机上上开发智能合约的成本也是不一样的。本手册将重点介绍使用 <code>WASN</code> 虚拟机涉及到的成本使用，本文将用表格的形式对比小型合约、中型合约和大型合约的不同开发成本，同时将 <code>PlatON</code> 的 <code>EVM</code>/<code>WASM</code>虚拟机和以太坊虚拟机之间进行对比。在合约方面，使用一个简单的<code>SET/GET</code>功能的合约作为小型测试合约，中型合约示例将使用一个开源的<a href="https://github.com/yep/eth-tweet">微博客</a>合约，而大型合约则是一个符合 <code>ERC20</code> 标准的智能合约。</p>
<h4><a class="anchor" aria-hidden="true" id="资源消耗"></a><a href="#资源消耗" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>资源消耗</h4>
<p><strong>简单set/get合约</strong></p>
<table>
<thead>
<tr><th style="text-align:left">系统</th><th style="text-align:left">合约级别</th><th style="text-align:left">合约大小</th><th style="text-align:left">消耗Gas</th><th style="text-align:left">Gas 单价</th><th style="text-align:left">能量损耗</th><th style="text-align:left">备注</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left">PlatON-EVM</td><td style="text-align:left">小型合约</td><td style="text-align:left">0.3 kb</td><td style="text-align:left">76953</td><td style="text-align:left">5,000,000,000 <code>VON</code></td><td style="text-align:left">384765 <code>gVON</code></td><td style="text-align:left">0.000384765 <code>LAT</code></td></tr>
<tr><td style="text-align:left">Ethereum</td><td style="text-align:left">小型合约</td><td style="text-align:left">0.3 kb</td><td style="text-align:left">127173</td><td style="text-align:left">5,000,000,000 <code>wei</code></td><td style="text-align:left">635865 <code>Gwei</code></td><td style="text-align:left">0.000635865 <code>ETH</code></td></tr>
<tr><td style="text-align:left">PlatON-WASM</td><td style="text-align:left">小型合约</td><td style="text-align:left">13.55 kb</td><td style="text-align:left">184043</td><td style="text-align:left">5,000,000,000 <code>VON</code></td><td style="text-align:left">920215 <code>gVON</code></td><td style="text-align:left">0.000920215 <code>LAT</code></td></tr>
</tbody>
</table>
<p><strong>微博客</strong></p>
<table>
<thead>
<tr><th style="text-align:left">系统</th><th style="text-align:left">合约级别</th><th style="text-align:left">合约大小</th><th style="text-align:left">消耗Gas</th><th style="text-align:left">Gas 单价</th><th style="text-align:left">能量损耗</th><th style="text-align:left">备注</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left">PlatON-EVM</td><td style="text-align:left">中型合约</td><td style="text-align:left">2.08 kb</td><td style="text-align:left">257065</td><td style="text-align:left">5,000,000,000 <code>VON</code></td><td style="text-align:left">1285325 <code>gVON</code></td><td style="text-align:left">0.001285325 <code>LAT</code></td></tr>
<tr><td style="text-align:left">Ethereum</td><td style="text-align:left">中型合约</td><td style="text-align:left">2.08 kb</td><td style="text-align:left">621385</td><td style="text-align:left">5,000,000,000 <code>wei</code></td><td style="text-align:left">3106925 <code>Gwei</code></td><td style="text-align:left">0.003106925 <code>ETH</code></td></tr>
<tr><td style="text-align:left">PlatON-WASM</td><td style="text-align:left">中型合约</td><td style="text-align:left">30.07 kb</td><td style="text-align:left">349713</td><td style="text-align:left">5,000,000,000 <code>VON</code></td><td style="text-align:left">1748565 <code>gVON</code></td><td style="text-align:left">0.001748565 <code>LAT</code></td></tr>
</tbody>
</table>
<p><strong>ERC20标准Token</strong></p>
<table>
<thead>
<tr><th style="text-align:left">系统</th><th style="text-align:left">合约级别</th><th style="text-align:left">合约大小</th><th style="text-align:left">消耗Gas</th><th style="text-align:left">Gas 单价</th><th style="text-align:left">能量损耗</th><th style="text-align:left">备注</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left">PlatON-EVM</td><td style="text-align:left">大型合约</td><td style="text-align:left">4.45 kb</td><td style="text-align:left">552823</td><td style="text-align:left">5,000,000,000 <code>VON</code></td><td style="text-align:left">2764115  <code>gVON</code></td><td style="text-align:left">0.002764115 <code>LAT</code></td></tr>
<tr><td style="text-align:left">Ethereum</td><td style="text-align:left">大型合约</td><td style="text-align:left">4.45 kb</td><td style="text-align:left">1282171</td><td style="text-align:left">5,000,000,000 <code>wei</code></td><td style="text-align:left">6410855  <code>Gwei</code></td><td style="text-align:left">0.006410855 <code>ETH</code></td></tr>
<tr><td style="text-align:left">PlatON-WASM</td><td style="text-align:left">大型合约</td><td style="text-align:left">35.9 kb</td><td style="text-align:left">486274</td><td style="text-align:left">5,000,000,000 <code>VON</code></td><td style="text-align:left">2431370  <code>gVON</code></td><td style="text-align:left">0.00243137 <code>LAT</code></td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="小型合约示例"></a><a href="#小型合约示例" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>小型合约示例</h3>
<h4><a class="anchor" aria-hidden="true" id="简单setget合约"></a><a href="#简单setget合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简单set/get合约</h4>
<p><strong>EVM示例代码</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">pragma</span> solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.12</span>;

contract SimpleTest {
    
    <span class="hljs-built_in">uint</span> <span class="hljs-keyword">public</span> age;
 
    <span class="hljs-built_in">function</span> setAge(<span class="hljs-built_in">uint</span> _input) <span class="hljs-keyword">public</span> {
        age = _input;
    }
 
    <span class="hljs-built_in">function</span> getAge() <span class="hljs-keyword">public</span> constant returns (<span class="hljs-built_in">uint</span>) {
        <span class="hljs-keyword">return</span> age;
    }
}
</code></pre>
<p>字节码</p>
<pre><code class="hljs"><span class="hljs-number">608060405234801561001057600080</span>fd<span class="hljs-number">5</span>b<span class="hljs-number">50610117806100206000396000</span>f<span class="hljs-number">3006080604052600436106053576000357</span><span class="hljs-keyword">c</span><span class="hljs-number">0100000000000000000000000000000000000000000000000000000000900463</span>ffffffff<span class="hljs-number">168063262</span>a<span class="hljs-number">9</span>dff<span class="hljs-number">146058578063967e6</span>e<span class="hljs-number">65146080578063</span>d<span class="hljs-number">5</span>dcf<span class="hljs-number">1271460</span>a<span class="hljs-number">8575</span>b<span class="hljs-number">600080</span>fd<span class="hljs-number">5</span>b<span class="hljs-number">348015606357600080</span>fd<span class="hljs-number">5</span>b<span class="hljs-number">50606</span>a<span class="hljs-number">60</span>d<span class="hljs-number">2565</span>b<span class="hljs-number">6040518082815260200191505060405180910390</span>f<span class="hljs-number">35</span>b<span class="hljs-number">348015608</span>b<span class="hljs-number">57600080</span>fd<span class="hljs-number">5</span>b<span class="hljs-number">50609260</span>d<span class="hljs-number">8565</span>b<span class="hljs-number">6040518082815260200191505060405180910390</span>f<span class="hljs-number">35</span>b<span class="hljs-number">34801560</span>b<span class="hljs-number">357600080</span>fd<span class="hljs-number">5</span>b<span class="hljs-number">5060</span>d<span class="hljs-number">06004803603810190808035906020019092919050505060e1565</span>b<span class="hljs-number">005</span>b<span class="hljs-number">60005481565</span>b<span class="hljs-number">60008054905090565</span>b<span class="hljs-number">80600081905550505600</span>a<span class="hljs-number">165627</span>a<span class="hljs-number">7</span>a<span class="hljs-number">7230582079e51340567895</span>e<span class="hljs-number">1097e1</span><span class="hljs-keyword">c</span><span class="hljs-number">9115e778</span><span class="hljs-keyword">c</span><span class="hljs-number">3</span>d<span class="hljs-number">982</span>b<span class="hljs-number">8e71</span>b<span class="hljs-number">6997</span><span class="hljs-keyword">c</span><span class="hljs-number">57</span>f<span class="hljs-number">1</span>ba<span class="hljs-number">497</span><span class="hljs-keyword">c</span><span class="hljs-number">56</span><span class="hljs-keyword">c</span><span class="hljs-number">8</span>b<span class="hljs-number">3</span>b<span class="hljs-number">0029</span>
</code></pre>
<p>字节大小：<code>311 byte =&gt; 0.3 kb</code></p>
<hr>
<p><strong>WASM示例代码</strong></p>
<pre><code class="hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;platon/platon.hpp&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> platon;

CONTRACT SimpleStorage: <span class="hljs-keyword">public</span> platon::Contract
{
    <span class="hljs-keyword">public</span>:
        <span class="hljs-function">ACTION <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>{}
    
        <span class="hljs-function">ACTION <span class="hljs-keyword">void</span> <span class="hljs-title">set</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> input)</span>
        </span>{
            storedData.self() = input;      
        }
        
        <span class="hljs-function">CONST <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">get</span><span class="hljs-params">()</span>
        </span>{
            <span class="hljs-keyword">return</span> storedData.self();
        }

    <span class="hljs-keyword">private</span>:
        platon::StorageType&lt;<span class="hljs-string">"sstored"</span>_n, <span class="hljs-keyword">uint64_t</span>&gt; storedData;
};

PLATON_DISPATCH(SimpleStorage,(init)(<span class="hljs-built_in">set</span>)(<span class="hljs-built_in">get</span>))
</code></pre>
<p>字节码</p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/SimpleStorage_wasm.bin">查看字节码</a></p>
<p>字节大小：<code>13882 byte =&gt; 13.55 kb</code></p>
<hr>
<h6><a class="anchor" aria-hidden="true" id="创建部署合约成本"></a><a href="#创建部署合约成本" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建&amp;部署合约成本</h6>
<p>PlatON-EVM</p>
<ul>
<li>Gas消耗: 76953</li>
<li>Gas单价: 5,000,000,000 (5 <code>gVON</code>)</li>
<li>总成本:  384765 <code>gVON</code>（0.000384765 <code>LAT</code>）</li>
</ul>
<p>以太坊</p>
<ul>
<li>Gas消耗: 127173</li>
<li>Gas单价: 5,000,000,000 (5 <code>Gwei</code>)</li>
<li>总成本:  635865 <code>Gwei</code>（0.000635865 <code>ETH</code>）</li>
</ul>
<p>PlatON-WASM</p>
<ul>
<li>Gas消耗: 184043</li>
<li>Gas单价: 5,000,000,000 (5 <code>gVON</code>)</li>
<li>总成本:  920215 <code>gVON</code>（0.000920215 <code>LAT</code>）</li>
</ul>
<hr>
<h3><a class="anchor" aria-hidden="true" id="中型合约示例"></a><a href="#中型合约示例" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>中型合约示例</h3>
<h4><a class="anchor" aria-hidden="true" id="微博客合约"></a><a href="#微博客合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>微博客合约</h4>
<p><strong>EVM示例代码</strong></p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/account.sol">点击查看微博客账户合约</a></p>
<p>字节码</p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/Tweet_wasm.bin">查看字节码</a></p>
<p>字节大小： <code>2130.5 byte =&gt; 2.08 kb</code></p>
<hr>
<p><strong>WASM示例代码</strong></p>
<pre><code class="hljs">#<span class="hljs-keyword">include</span> &lt;platon/platon.hpp&gt;
#<span class="hljs-keyword">include</span> &lt;<span class="hljs-built_in">string</span>&gt;
using namespace platon;

<span class="hljs-comment">// data structure of a single tweet.</span>
<span class="hljs-keyword">struct</span> Tweet{

    public:
        uint64_t timestamp;
        std::<span class="hljs-built_in">string</span> tweetString;

    public:
        <span class="hljs-constructor">Tweet()</span>{}
        <span class="hljs-constructor">Tweet(<span class="hljs-params">uint64_t</span> &amp;<span class="hljs-params">timestamp</span>, <span class="hljs-params">const</span> <span class="hljs-params">std</span>::<span class="hljs-params">string</span> &amp;<span class="hljs-params">tweet</span>)</span>:timestamp(timestamp), tweet<span class="hljs-constructor">String(<span class="hljs-params">tweet</span>)</span> {
        }

    public:
        <span class="hljs-constructor">PLATON_SERIALIZE(Tweet, (<span class="hljs-params">timestamp</span>)</span>(tweetString))
};

CONTRACT TweetAccount: public platon::Contract
{
    <span class="hljs-keyword">private</span>:
        <span class="hljs-comment">// "array" of all tweets of this account: maps the tweet id to the actual tweet.</span>
        platon::StorageType&lt;<span class="hljs-string">"smapping"</span>_n, std::map&lt;std::uint64_t, Tweet&gt;&gt; _tweets;
        <span class="hljs-comment">// total number of tweets in the above _tweets mapping.</span>
        platon::StorageType&lt;<span class="hljs-string">"suint"</span>_n, uint64_t&gt; _numberOfTweets;
        <span class="hljs-comment">// "owner" of this account: only admin is allowed to tweet.</span>
        platon::StorageType&lt;<span class="hljs-string">"saddress"</span>_n, Address&gt; _adminAddress;
    
    public:
        ACTION void init<span class="hljs-literal">()</span>
        {
            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_numberOfTweets</span>.</span></span>self<span class="hljs-literal">()</span> = <span class="hljs-number">0</span>;
            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_adminAddress</span>.</span></span>self<span class="hljs-literal">()</span> = platon::platon<span class="hljs-constructor">_caller()</span>;
        }
        
        <span class="hljs-comment">// returns true if caller of function("sender") is admin.</span>
        CONST <span class="hljs-built_in">bool</span> is<span class="hljs-constructor">Admin()</span>{
            return platon::platon<span class="hljs-constructor">_caller()</span><span class="hljs-operator"> == </span><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_adminAddress</span>.</span></span>self<span class="hljs-literal">()</span>;     
        }
    
        <span class="hljs-comment">// create new tweet</span>
        ACTION int64_t tweet(const std::<span class="hljs-built_in">string</span>&amp; tweetString) {
            int64_t result = <span class="hljs-number">0</span>;     
            <span class="hljs-keyword">if</span>(!is<span class="hljs-constructor">Admin()</span>){
                <span class="hljs-comment">// only owner is allowed to create tweets for this account.</span>
                result = -<span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tweetString.length<span class="hljs-literal">()</span> &gt; <span class="hljs-number">160</span>) {
                <span class="hljs-comment">// tweet contains more than 160 bytes.</span>
                result = -<span class="hljs-number">2</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_tweets</span>.</span></span>self<span class="hljs-literal">()</span><span class="hljs-literal">[<span class="hljs-identifier">_numberOfTweets</span>]</span>.timestamp = platon<span class="hljs-constructor">_timestamp()</span>;
                <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_tweets</span>.</span></span>self<span class="hljs-literal">()</span><span class="hljs-literal">[<span class="hljs-identifier">_numberOfTweets</span>]</span>.tweetString = tweetString;
                <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_numberOfTweets</span>.</span></span>self<span class="hljs-literal">()</span> = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_numberOfTweets</span>.</span></span>self<span class="hljs-literal">()</span> + <span class="hljs-number">1</span>;    
                result = <span class="hljs-number">0</span>; <span class="hljs-comment">// success.     </span>
            }
            return result;
        }

        CONST std::<span class="hljs-built_in">string</span> get<span class="hljs-constructor">Tweet(<span class="hljs-params">uint64_t</span> <span class="hljs-params">tweetId</span>)</span>{
            <span class="hljs-comment">// returns two values </span>
            std::<span class="hljs-built_in">string</span> tweetString = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_tweets</span>.</span></span>self<span class="hljs-literal">()</span><span class="hljs-literal">[<span class="hljs-identifier">tweetId</span>]</span>.tweetString;
            uint64_t timestamp = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_tweets</span>.</span></span>self<span class="hljs-literal">()</span><span class="hljs-literal">[<span class="hljs-identifier">tweetId</span>]</span>.timestamp;
            return tweetString;     
        }
    
        CONST std::<span class="hljs-built_in">string</span> get<span class="hljs-constructor">LatestTweet()</span> {
            <span class="hljs-comment">// returns three values.</span>
            std::<span class="hljs-built_in">string</span> tweetString = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_tweets</span>.</span></span>self<span class="hljs-literal">()</span><span class="hljs-literal">[<span class="hljs-identifier">_numberOfTweets</span>.<span class="hljs-identifier">self</span>() - <span class="hljs-number">1</span>]</span>.tweetString;
            uint64_t timestamp = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_tweets</span>.</span></span>self<span class="hljs-literal">()</span><span class="hljs-literal">[<span class="hljs-identifier">_numberOfTweets</span>.<span class="hljs-identifier">self</span>() - <span class="hljs-number">1</span>]</span>.timestamp;
            uint64_t numberOfTweets = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_numberOfTweets</span>.</span></span>self<span class="hljs-literal">()</span>;
            return tweetString;     
        } 
        
        CONST Address get<span class="hljs-constructor">OwnerAddress()</span> {
            return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_adminAddress</span>.</span></span>self<span class="hljs-literal">()</span>;        
        }

        CONST uint64_t get<span class="hljs-constructor">NumberOfTweets()</span> {
            return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_numberOfTweets</span>.</span></span>self<span class="hljs-literal">()</span>;          
        }
        
        ACTION void admin<span class="hljs-constructor">RetrieveDonations(<span class="hljs-params">const</span> Address&amp; <span class="hljs-params">receiver</span>)</span> {
            <span class="hljs-keyword">if</span>(is<span class="hljs-constructor">Admin()</span>){
                Address caddr = platon<span class="hljs-constructor">_address()</span>;
                Energon e = platon<span class="hljs-constructor">_balance(<span class="hljs-params">caddr</span>)</span>;
                platon<span class="hljs-constructor">_transfer(<span class="hljs-params">receiver</span>, <span class="hljs-params">e</span>)</span>;
            }       
        }
        
        CONST Address caddr<span class="hljs-literal">()</span>{
            return platon<span class="hljs-constructor">_address()</span>;        
        }
    
        CONST std::<span class="hljs-built_in">string</span> caddr<span class="hljs-constructor">Balance(Address <span class="hljs-params">receiver</span>)</span>{
            <span class="hljs-comment">//Address caddr = platon_address();</span>
            Energon e = platon<span class="hljs-constructor">_balance(<span class="hljs-params">receiver</span>)</span>;
            return std::<span class="hljs-keyword">to</span><span class="hljs-constructor">_string(<span class="hljs-params">e</span>.Get()</span>);     
        }
            
        ACTION void admin<span class="hljs-constructor">DeleteAccount()</span>{
            <span class="hljs-keyword">if</span>(is<span class="hljs-constructor">Admin()</span>){
                <span class="hljs-comment">// this is a predefined function, it deletes theh contract and returns all funds to the owner.  </span>
                platon<span class="hljs-constructor">_destroy(<span class="hljs-params">_adminAddress</span>.<span class="hljs-params">self</span>()</span>);   
            }       
        }
};

<span class="hljs-constructor">PLATON_DISPATCH(TweetAccount,(<span class="hljs-params">init</span>)</span>(isAdmin)(tweet)(getTweet)(getLatestTweet)
(getOwnerAddress)(getNumberOfTweets)(adminRetrieveDonations)(adminDeleteAccount)
(caddr)(caddrBalance))
</code></pre>
<p>字节码</p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/Tweet_wasm.bin">查看字节码</a></p>
<p>字节大小： <code>30788</code> byte =&gt; 30.07 kb`</p>
<hr>
<h6><a class="anchor" aria-hidden="true" id="创建部署合约成本-1"></a><a href="#创建部署合约成本-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建&amp;部署合约成本</h6>
<p>PlatON-EVM</p>
<ul>
<li>Gas消耗: 257065</li>
<li>Gas单价: 5,000,000,000 (5 <code>gVON</code>)</li>
<li>总成本:  1285325 <code>gVON</code>（0.001285325 <code>LAT</code>）</li>
</ul>
<p>以太坊</p>
<ul>
<li>Gas消耗: 621385</li>
<li>Gas单价: 5,000,000,000 (5 <code>Gwei</code>)</li>
<li>总成本:  3106925 <code>Gwei</code>（0.003106925 <code>ETH</code>）</li>
</ul>
<p>PlatON-WASM</p>
<ul>
<li>Gas消耗: 349713</li>
<li>Gas单价: 5,000,000,000 (5 <code>gVON</code>)</li>
<li>总成本:  1748565 <code>gVON</code>（0.001748565 <code>LAT</code>）</li>
</ul>
<hr>
<h3><a class="anchor" aria-hidden="true" id="大型合约示例"></a><a href="#大型合约示例" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>大型合约示例</h3>
<h4><a class="anchor" aria-hidden="true" id="erc20标准token合约"></a><a href="#erc20标准token合约" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ERC20标准token合约</h4>
<p><strong>EVM示例代码</strong></p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/token.sol">点击查看ERC20标准的智能合约</a></p>
<p>字节码</p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/Token_evm.bin">查看字节码</a></p>
<p>字节大小： <code>4557.5 byte =&gt; 4.45 kb</code></p>
<hr>
<p><strong>WASM示例代码</strong></p>
<pre><code class="hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;platon/platon.hpp&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> platon;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Token</span> {</span>
    <span class="hljs-keyword">public</span>:
        <span class="hljs-comment">// total amount of tokens</span>
        platon::StorageType&lt;<span class="hljs-string">"totalsupply"</span>_n, <span class="hljs-keyword">uint64_t</span>&gt; totalSupply;
    
    <span class="hljs-keyword">public</span>: <span class="hljs-comment">// event</span>
        <span class="hljs-comment">// define: _from, _to, _value</span>
        PLATON_EVENT2(Transfer, Address, Address, <span class="hljs-keyword">uint64_t</span>);
        <span class="hljs-comment">// define: _owner, _spender, _value</span>
        PLATON_EVENT2(Approval, Address, Address, <span class="hljs-keyword">uint64_t</span>);

    <span class="hljs-keyword">public</span>:
        <span class="hljs-comment">// @param _owner The address from which the balance will be retrieved</span>
        <span class="hljs-comment">// @return The balance.</span>
        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">balanceOf</span><span class="hljs-params">(Address _owner)</span> </span>= <span class="hljs-number">0</span>;

        <span class="hljs-comment">// @notice send '_value' token to `_to` from `msg.sender`</span>
        <span class="hljs-comment">// @param _to THe address of the recipient.</span>
        <span class="hljs-comment">// @param _value The amount of token to be transferred.</span>
        <span class="hljs-comment">// @return Whether the transfer was successful or not.</span>
        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">transfer</span><span class="hljs-params">(Address _to, <span class="hljs-keyword">uint64_t</span> _value)</span> </span>= <span class="hljs-number">0</span>;

        <span class="hljs-comment">// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`</span>
        <span class="hljs-comment">// @param _from The address of the sender.</span>
        <span class="hljs-comment">// @param _to The address of the recepient.</span>
        <span class="hljs-comment">// @param _value The amount of token to be transferred.</span>
        <span class="hljs-comment">// @return Whether the transfer was successful or not.</span>
        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">transferFrom</span><span class="hljs-params">(Address _from, Address _to, <span class="hljs-keyword">uint64_t</span> _value)</span> </span>= <span class="hljs-number">0</span>;

        <span class="hljs-comment">// @notice `msg.sender` approves `_spender` to spend `_value` tokens</span>
        <span class="hljs-comment">// @param _spender The address of the account able to transfer the tokens</span>
        <span class="hljs-comment">// @param _value The amount of tokens to be approved for transfer</span>
        <span class="hljs-comment">// @return Whether thee approval was successful or not.</span>
        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">approve</span><span class="hljs-params">(Address _spender, <span class="hljs-keyword">uint64_t</span> _value)</span> </span>= <span class="hljs-number">0</span>;

        <span class="hljs-comment">// @param _owner The address of the account owning tokens</span>
        <span class="hljs-comment">// @param _spender The address of the account able to transfer the tokens</span>
        <span class="hljs-comment">// @return Amount of remaining tokens allowed to spent.</span>
        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">allowance</span><span class="hljs-params">(Address _owner, Address _spender)</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-comment">// You should inherit from StandardTOken or, for a token like you would want</span>
<span class="hljs-comment">// to deploy in something like MIst, see HumanStandardToken.cpp.</span>
<span class="hljs-comment">// (This implements ONLY the standard functions and NOTHING else.</span>
<span class="hljs-comment">// If you deploy this, you won't have anthing useful.)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StandardToken</span>:</span> <span class="hljs-keyword">public</span> Token
{
    <span class="hljs-keyword">protected</span>: 
        platon::StorageType&lt;<span class="hljs-string">"balances"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;Address, <span class="hljs-keyword">uint64_t</span>&gt;&gt; balances;
        platon::StorageType&lt;<span class="hljs-string">"allowed"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;Address, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;Address, <span class="hljs-keyword">uint64_t</span>&gt;&gt;&gt; allowed;

    <span class="hljs-keyword">public</span>:
        <span class="hljs-function">CONST <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">balanceOf</span><span class="hljs-params">(Address _owner)</span> </span>{
            <span class="hljs-keyword">return</span> balances.self()[_owner];     
        }

        <span class="hljs-function">ACTION <span class="hljs-keyword">bool</span> <span class="hljs-title">transfer</span><span class="hljs-params">(Address _to, <span class="hljs-keyword">uint64_t</span> _value)</span></span>{
            <span class="hljs-comment">// Default assumes totalSupply can't be over max(2^64 - 1)</span>
            <span class="hljs-comment">// If your token leaves out totalSupply and can issue more tokens as time goes on,</span>
            <span class="hljs-comment">// you need to check if it doesn't wrap.</span>
            <span class="hljs-comment">// Replace the if with this on instead.</span>
            Address sender = platon_caller();
            <span class="hljs-keyword">if</span> (balances.self()[sender] &gt;= _value &amp;&amp; _value &gt; <span class="hljs-number">0</span>) {
                balances.self()[sender] -= _value;
                balances.self()[_to] += _value;
                PLATON_EMIT_EVENT2(Transfer, sender, _to, _value);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;           
            }
        }

        <span class="hljs-function">ACTION <span class="hljs-keyword">bool</span> <span class="hljs-title">transferFrom</span><span class="hljs-params">(Address _from, Address _to, <span class="hljs-keyword">uint64_t</span> _value)</span> </span>{
            <span class="hljs-comment">// same as above. Replace this line with the following if you want to protect against</span>
            <span class="hljs-comment">// wrapping uints.</span>
            Address sender = platon_caller();
            <span class="hljs-keyword">if</span>(balances.self()[_from] &gt;= _value 
                &amp;&amp; allowed.self()[_from][sender] &gt;= _value &amp;&amp; _value &gt; <span class="hljs-number">0</span>){
                balances.self()[_to] += _value;
                balances.self()[_from] -= _value;
                PLATON_EMIT_EVENT2(Transfer, _from, _to, _value);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;           
            }
        }

        <span class="hljs-function">ACTION <span class="hljs-keyword">bool</span> <span class="hljs-title">approve</span><span class="hljs-params">(Address _spender, <span class="hljs-keyword">uint64_t</span> _value)</span></span>{
            Address sender = platon_caller();           
            allowed.self()[sender][_spender] = _value;
            PLATON_EMIT_EVENT2(Approval, sender, _spender, _value);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;        
        }

        <span class="hljs-function">CONST <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">allowance</span><span class="hljs-params">(Address _owner, Address _spender)</span></span>{
            <span class="hljs-keyword">return</span> allowed.self()[_owner][_spender];        
        }
};


CONTRACT LATToken: <span class="hljs-keyword">public</span> platon::Contract, <span class="hljs-keyword">public</span> StandardToken
{
    
    <span class="hljs-keyword">public</span>:
        platon::StorageType&lt;<span class="hljs-string">"name"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; name;        <span class="hljs-comment">// fancy name: eg PlatON Token</span>
        platon::StorageType&lt;<span class="hljs-string">"decimals"</span>_n, <span class="hljs-keyword">uint8_t</span>&gt; decimals;    <span class="hljs-comment">// HOw many decimals to show.</span>
        platon::StorageType&lt;<span class="hljs-string">"symbol"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; symbol;    <span class="hljs-comment">// An identifier: eg LTT</span>
        platon::StorageType&lt;<span class="hljs-string">"version"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; version;  <span class="hljs-comment">// 0.1 standard. Just an arbitrary versioning scheme.</span>

    <span class="hljs-keyword">public</span>:
        <span class="hljs-function">ACTION <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> _initialAmount, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; _tokenName,
            <span class="hljs-keyword">uint8_t</span> _decimalUnits, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; _tokenSymbol)</span>
        </span>{
            Address sender = platon_caller();
            balances.self()[sender] = _initialAmount;       <span class="hljs-comment">// Give the creator all initial tokens.</span>
            totalSupply.self() = _initialAmount;            <span class="hljs-comment">// Update total supply.</span>
            name.self() = _tokenName;                       <span class="hljs-comment">// Set the name for display purposes</span>
            decimals.self() = _decimalUnits;                <span class="hljs-comment">// Amount of decimals for display purposes</span>
            symbol.self() = _tokenSymbol;                   <span class="hljs-comment">// Set the symbol for display purposes.</span>
        }

        <span class="hljs-function">CONST <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>{
            <span class="hljs-keyword">return</span> name.self();     
        }

        <span class="hljs-function">CONST <span class="hljs-keyword">uint8_t</span> <span class="hljs-title">getDecimals</span><span class="hljs-params">()</span></span>{
            <span class="hljs-keyword">return</span> decimals.self();     
        }

        <span class="hljs-function">CONST <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">getSymbol</span><span class="hljs-params">()</span></span>{
            <span class="hljs-keyword">return</span> symbol.self();       
        }

        <span class="hljs-function">CONST <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">getTotalSupply</span><span class="hljs-params">()</span></span>{
            <span class="hljs-keyword">return</span> totalSupply.self();      
        }
        
        <span class="hljs-comment">// Approves and then calls the receiving contract.</span>
        <span class="hljs-function">ACTION <span class="hljs-keyword">bool</span> <span class="hljs-title">approveAndCall</span><span class="hljs-params">(Address _spender, <span class="hljs-keyword">uint64_t</span> _value, <span class="hljs-keyword">const</span> bytes&amp; _extraData)</span> </span>{
            Address sender = platon_caller();
            allowed.self()[sender][_spender] = _value;
            PLATON_EMIT_EVENT2(Approval, sender, _spender, _value);
            <span class="hljs-comment">// call the receiveApproval function on the contract you want to be notified. This </span>
            <span class="hljs-comment">// crafts the function signature manually so one doesn't have to include a contract </span>
            <span class="hljs-comment">// in here just for this.</span>
            <span class="hljs-comment">// define: receiveApproval(Address _from, uint64_t _value, Address _tokenContract, bytes&amp; _extraDaa)</span>
            <span class="hljs-comment">// it is assumed that when does this that the call should succeed.</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
};

PLATON_DISPATCH(LATToken,(init)(balanceOf)(<span class="hljs-built_in">transfer</span>)(transferFrom)(approve)(allowance)
(getName)(getDecimals)(getSymbol)(getTotalSupply)(approveAndCall))
</code></pre>
<p>字节码</p>
<p><a href="https://github.com/PlatONnetwork/Docs/blob/master/zh-cn/Development/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BC%80%E5%8F%91.assets/Token_wasm.bin">查看字节码</a></p>
<p>字节大小： <code>36764 byte =&gt; 35.9 kb</code></p>
<hr>
<h6><a class="anchor" aria-hidden="true" id="创建部署合约成本-2"></a><a href="#创建部署合约成本-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建&amp;部署合约成本</h6>
<p>PlatON-EVM</p>
<ul>
<li>Gas消耗: 552823</li>
<li>Gas单价: 5,000,000,000 (5 <code>gVON</code>)</li>
<li>总成本:  2764115 <code>gVON</code>（0.002764115 <code>LAT</code>）</li>
</ul>
<p>以太坊</p>
<ul>
<li>Gas消耗: 1282171</li>
<li>Gas单价: 5,000,000,000 (5 <code>Gwei</code>)</li>
<li>总成本:  6410855 <code>Gwei</code>（0.006410855 <code>ETH</code>）</li>
</ul>
<p>PlatON-WASM</p>
<ul>
<li>Gas消耗: 486274</li>
<li>Gas单价: 5,000,000,000 (5 <code>gVON</code>)</li>
<li>总成本:  2431370 <code>gVON</code>（0.00243137 <code>LAT</code>）</li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="最佳实践"></a><a href="#最佳实践" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最佳实践</h2>
<h3><a class="anchor" aria-hidden="true" id="介绍"></a><a href="#介绍" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>介绍</h3>
<p>本指南向用户介绍智能合约开发中需要关注的一些关键点,主要偏向于在实际开发中的实践.
用户可以通过本指南快速了解针对一笔交易如何合理的设置手续费, 如何避免被因交易失败
的同时损失手续费以及如何编码更加规范的智能合约.</p>
<h3><a class="anchor" aria-hidden="true" id="费用合理设置"></a><a href="#费用合理设置" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>费用合理设置</h3>
<p>当需要在 <code>PlatON</code> 的主网上部署合约时, 需要设置一个合理的费用限制. 费用限制是指
<code>PlatON</code> 中智能合约部署/执行的能源消耗成本的上限. 该限制主要通过 <code>Gas</code> 完成,
<code>Gas</code> 是 <code>PlatON</code> 网络世界的燃料值, 它决定了 <code>PlatON</code> 网络生态系统的正常运行. 通
常使用 <code>Gas</code> 来衡量执行某些动作需要多少&quot;工作量&quot;, 这些工作量就是为了执行该动作所
需要支付给 <code>PlatON</code> 网络的费用额度. 简单理解, <code>Gas</code> 是网络旷工的佣金, 并通过
<code>LAT</code> 的方式支付, 在网络上的任何交易, 合约执行, 数据存储, 都需要使用到 <code>Gas</code>.</p>
<p>PlatON 与以太坊区块链系统类似, 使用 <code>LAT</code> 进行支付和维护网络, 一枚 <code>LAT</code> 分为:
<code>mLAT/uLAT/gVON/mVON/kVON/VON</code>, 其中VON是最小单位.</p>
<p><code>Gas</code> 主要由两个部分组成: GasLimit(限制)和GasPrice(单价). 其中 <code>GasLimit</code> 是用户
愿意为执行某个操作或确认交易支付的最大 <code>Gas</code> 消耗量(最少21,000). GasPrice是
<code>VON</code> 的数量, 用于愿意为每个 <code>Gas</code> 所支付的单价.</p>
<p>用户发送一笔交易时, 会设定 <code>GasLimit</code> 和 <code>GasPrice</code>, 二者的乘积(GasLimit *
GasPrice)是用户的交易成本, 同时该成本会作为佣金奖励给旷工.</p>
<p>交易设置的 <code>GasPrice</code> 越高, 则交易的执行优先级更高, 交易成本也会更大. 每笔交易在
完成后, 剩余未使用的Gas都会退回到发送者的地址账户中. 有一点要特别注意, 如果因为
<code>GasLimit</code> 设置过低导致交易执行失败, 此时的 <code>Gas</code> 不会被回退到用户地址, 用户依然
需要为这次失败的交易支付能量成本. 因此, 无论交易是否执行成功, 交易发送者都需要向旷工支付一定的计算费用.</p>
<p>在 <code>PlatON</code> 网络中, 默认最高 <code>Gas</code> 的限制为 <code>100,800,000</code>, 最低为 <code>22,000</code>, 过低或者过高都会导
致交易失败. 在部署大型合约或者运行复杂功能时, 可以将Gas的限制调高, 例如:
<code>1,000,000</code>. 如果是普通转账则设置为最低值即可. 具体的值需要根据合约的规模及复杂度
进行估算, 在合约发布前可以调用接口 <code>platon_estimateGas</code> 进行大概估算, 避免因不足而导致失败.</p>
<p><strong>LAT 单位转换</strong></p>
<table>
<thead>
<tr><th>单位</th><th>VON值</th><th>VON</th></tr>
</thead>
<tbody>
<tr><td>VON</td><td>1</td><td>1</td></tr>
<tr><td>kVON</td><td>1e3 VON</td><td>1,000</td></tr>
<tr><td>mVON</td><td>1e6 VON</td><td>1,000,000</td></tr>
<tr><td>gVON</td><td>1e9 VON</td><td>1,000,000,000</td></tr>
<tr><td>microLAT</td><td>1e12 VON</td><td>1,000,000,000,000</td></tr>
<tr><td>milliLAT</td><td>1e15 VON</td><td>1,000,000,000,000,000</td></tr>
<tr><td>LAT</td><td>1e18 VON</td><td>1,000,000,000,000,000,000</td></tr>
<tr><td>kLAT</td><td>1e21 VON</td><td>1,000,000,000,000,000,000,000</td></tr>
<tr><td>mLAT</td><td>1e24 VON</td><td>1,000,000,000,000,000,000,000,000</td></tr>
<tr><td>gLAT</td><td>1e27 VON</td><td>1,000,000,000,000,000,000,000,000,000</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="避免超时"></a><a href="#避免超时" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>避免超时</h3>
<p>在 <code>PlatON</code> 网络上发送交易, 没有超时的概念, 但是最终会根据所设置的 Gas 限制值停
止, 如果限制值低于合约部署所需要的消耗, 则交易发送失败, 同时会扣除对应的手续费.
手续费的设定不可能无限大, 因为在网络中, 区块本身有一个最大的 Gas 上限, 当交易的
<code>GasLimit</code> 超过该值时, 交易将无法被接收.</p>
<p>如果是针对已发布的合约执行 <code>call</code> 调用(call调用指合约逻辑内无状态变更操作), 存在
<code>5s</code> 超时的限制, 如果在 <code>5s</code> 内合约逻辑没有执行完成, 虚拟机会超时强制退出, 导致查询失败.</p>
<p>为避免部署合约交易失败, 请尝试将大型合约分成较小的块, 并根据需要相互引用. 为了避
免无限循环, 请注意常见的陷阱和递归调用.</p>
<h3><a class="anchor" aria-hidden="true" id="非法操作处罚"></a><a href="#非法操作处罚" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>非法操作处罚</h3>
<p>如果智能合约不是通过标准有效的编译器编译合约或者随意的更改指令码, 都会导致操作码
无效. 此类合约不仅无法部署和执行成功, 而且还会产生 <code>GasLimit*GasPrice</code> 的全额惩
罚, 当次交易的手续费会全部被扣除, 这是一个力度很大的惩罚, 如果操作者没注意该点,
不断重试, 那么付出的成本会更高, 代价更重.</p>
<p>一般产生无效操作码有以下情况:</p>
<ol>
<li>对正常已编译出的合约手动更改了指令码</li>
<li>合约编译器版本与网络锁支持的合约版本不一致</li>
<li>使用浮点数运算</li>
</ol>
<p>在 <code>PlatON</code> 网络中操作合约时, 请务必先确认当前网络所支持的智能合约版本, 然后选择对应版本对的编译器.</p>
<p>常规操作是使用 <code>PlatON</code> 社区提供的最新的Truffle/PlatON-CDT来编译/部署/执行合约,
同时在切换到主网操作前, 务必在测试网进行有效的验证.</p>
<h3><a class="anchor" aria-hidden="true" id="cc语言限制"></a><a href="#cc语言限制" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>C/C++语言限制</h3>
<p><strong>C/C++不支持的特性</strong></p>
<ul>
<li>浮点数(float/double)</li>
<li>typeid/dynamic_cast(-fno-rtti)</li>
<li>try-catch(-fno-exeception)</li>
<li>C++17之后的特性</li>
</ul>
<p><strong>libc不支持的头文件</strong></p>
<ul>
<li>signal.h</li>
<li>math.h</li>
<li>locale.h</li>
<li>errno.h</li>
<li>uchar.h</li>
<li>time.h</li>
</ul>
<p><strong>libc++不支持的头文件</strong></p>
<ul>
<li>rand</li>
<li>atomics</li>
<li>thread</li>
<li>random</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="编程规范"></a><a href="#编程规范" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>编程规范</h3>
<h4><a class="anchor" aria-hidden="true" id="命名规范"></a><a href="#命名规范" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>命名规范</h4>
<ul>
<li><p>函数命名, 变量命名, 文件命名要有描述性</p></li>
<li><p>采用区块链行业内的术语</p></li>
<li><p>尽可能少的使用缩写, 如果一定使用, 则推荐使用公共缩写和习惯缩写等</p></li>
<li><p>文件名要全部小写, 可以包含下划线(<code>_</code>)或连字符(<code>-</code>)</p></li>
<li><p>WASM智能合约, 文件名与合约名保持一致</p></li>
<li><p>类型名称的每个首字母均大写, 不包含下划线: <code>MyExcitingClass</code>, <code>MyExcitingEnum</code></p></li>
<li><p>变量(包括函数参数)和数据成员一律小写, 单词之间用下划线连接. 类的成员变量以下划
线结尾, 但结构体的就不用, 如: <code>a_local_variable</code>, <code>a_struct_data_member</code>,
<code>a_class_data_memeber_</code></p></li>
<li><p>声明为 <code>constexpr</code> 或 <code>const</code> 的常量, 或在合约执行过程中其值始终保持不变的, 命
名时以 &quot;k&quot; 开头, 大小写混合. 例如:</p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> kDaysInAWeek = <span class="hljs-number">7</span>;
</code></pre></li>
<li><p>常规函数使用大小写混合, 取值和设值函数则要求与变量名匹配:
<code>MyExcitingFunctio()</code>, <code>MyExcitingMethod()</code>, <code>my_exciting_member_variable()</code>, <code>set_my_exciting_member_variable()</code></p></li>
<li><p>枚举的命名应该和常量或宏一致: <code>kEnumName</code> 或 <code>ENUM_NAME</code></p></li>
<li><p>如果你的命名实体与已有的C/C++实体相似, 可参考现有命名策略</p></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="智能合约文件组织"></a><a href="#智能合约文件组织" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>智能合约文件组织</h4>
<p>文件组织规则:</p>
<ul>
<li>一般超过1000行的程序代码就比较难以阅读, 尽量避免出现一个文件内代码行数过长的情
况. 每个合约文件应只包含一个单一的合约类或合约接口.</li>
</ul>
<p>文件组织顺序:</p>
<ul>
<li>文件注释: 所有合约源文件在开头有一个注释, 其中列出文件的版权声明, 文件名, 功能
描述及创建, 修改记录.</li>
<li>类或接口注释: 在类/接口定义之前应该进行注释, 包括类/接口的描述, 最新修改者, 版
本号, 参考链接等.</li>
<li>类成员: 首先是公共级别的, 随后是保护级别的, 最后是私有级别.</li>
<li>成员函数：合约内的函数应该按功能分组, 而不应该按作用域或访问权限进行分组.</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="特性使用建议"></a><a href="#特性使用建议" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>特性使用建议</h4>
<h5><a class="anchor" aria-hidden="true" id="结构体-vs-类"></a><a href="#结构体-vs-类" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结构体 vs. 类</h5>
<p>仅当只有数据成员时使用 <code>struct</code>, 其他一概使用 <code>class</code>.</p>
<p>在 C++ 中 <code>struct</code> 和 <code>class</code> 关键字几乎含义一样. 我们为这两个关键字添加我们自
己的语义理解, 以便为定义的数据类型选择合适的关键字.</p>
<p><code>struct</code> 用来定义包含数据的被动式对象, 也可以包含相关的常量, 但除了存取数据成员
之外, 没有别的函数功能. 并且存取功能是通过直接访问位域, 而非函数调用. 除了构造函
数, 析构函数, <code>Initialize()</code>, <code>Reset()</code>, <code>Validate()</code> 等类似的用于设定数据成员的
函数外, 不能提供其它功能的函数.</p>
<p>如果需要更多的函数功能, <code>class</code> 更适合. 如果拿不准, 就用 <code>class</code>.</p>
<h5><a class="anchor" aria-hidden="true" id="继承"></a><a href="#继承" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>继承</h5>
<p>使用组合常常比使用继承更合理. 如果使用继承的话, 定义为 <code>public</code> 继承.</p>
<p>所有继承必须是 <code>public</code> 的. 如果你想使用私有继承, 你应该替换成把基类的实例作为成员对象的方式.</p>
<p>不要过度使用实现继承. 组合常常更合适一些. 尽量做到只在 &quot;is-a&quot; 的情况下使用继承:
如果 Bar 的确 &quot;是一种&quot; Foo, Bar 才能继承 Foo.</p>
<h5><a class="anchor" aria-hidden="true" id="多重继承"></a><a href="#多重继承" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>多重继承</h5>
<p>多重继承尤其成问题，因为它通常会带来更高的性能开销 (实际上, 从单继承到多重继承的
性能下降通常可能大于从普通派发到虚拟调度的性能下降), 并且由于存在导致 &quot;diamond&quot; 的风
险”的继承模式，容易产生歧义，混淆和彻底的错误。</p>
<p><strong>强烈建议不要使用多重继承.</strong></p>
<h5><a class="anchor" aria-hidden="true" id="move"></a><a href="#move" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>move</h5>
<p>C++11引入的 <code>std::move</code>, 能有效的把资源转移给其他对象. 在我们的实践中, 使用
<code>std::move</code> 能有效减少 <code>Gas</code> 的消耗, 特别是使用容器的时候. 在返回值时, 应当返回
右值引用并使用 <code>std::move</code> 将左值引用转换为右值引用, 以减少 <code>Gas</code> 消耗. 例如:</p>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;&amp;&amp; <span class="hljs-title">get_vec</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; v;
    <span class="hljs-comment">// ignore</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::move(v); <span class="hljs-comment">// very important</span>
}
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="auto"></a><a href="#auto" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>auto</h5>
<p><code>auto</code> 关键字能够通过初始化器自动推导其类型, 配合容器，迭代器使用能简化代码. 例如:</p>
<pre><code class="hljs css language-cpp"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; my_map;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = my_map.begin(); it != my_map.end(); it++) {
    <span class="hljs-comment">// ignore</span>
}
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="引用参数"></a><a href="#引用参数" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引用参数</h5>
<p>建议所有函数参数都使用引用参数. 引用参数可以减少不必要的复制, 减少不必要的内存分
配，对于我们的WASM虚拟机来说, 内存分配是一个昂贵的操作.</p>
<h5><a class="anchor" aria-hidden="true" id="容器"></a><a href="#容器" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>容器</h5>
<p>C++标准库提供了一些常用的容器(map, vector, list等等), 在使用时应当仔细阅读对应的接口文档. 特别需要注意的是 map 的 <code>operator[]</code> 操作符, 根据接口文档说明, <code>operator[]</code> 当 key 不存在时, 会执行插入动作. 对应合约开发来说, 使用 <code>StorageType</code> 存储 map 时, 不要通过 <code>operator[]</code> 判断 key 是否存在, 而应该通过 <code>find()</code>.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="api"></a><a href="#api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API</h2>
<h3><a class="anchor" aria-hidden="true" id="区块api"></a><a href="#区块api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>区块Api</h3>
<h4><a class="anchor" aria-hidden="true" id="platon_block_hash"></a><a href="#platon_block_hash" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_block_hash()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">h256 <span class="hljs-title">platon::platon_block_hash</span><span class="hljs-params">(<span class="hljs-keyword">int64_t</span> num)</span>
</span></code></pre>
<p>根据区块高度获取区块哈希。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>num：</code>块的高度</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>哈希值</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_block_number"></a><a href="#platon_block_number" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_block_number()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">platon_block_number</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取当前块的高度。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>当前块的高度</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_coinbase"></a><a href="#platon_coinbase" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_coinbase()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">Address <span class="hljs-title">platon::platon_coinbase</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取矿工节点的哈希值。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>矿工节点的哈希</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_unix_timestamp"></a><a href="#platon_unix_timestamp" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_unix_timestamp()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">int64_t</span> <span class="hljs-title">platon::platon_unix_timestamp</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取当前块的Unix时间戳。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>当前块的Unix时间戳（秒）</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_gas_limit"></a><a href="#platon_gas_limit" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_gas_limit()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">platon_gas_limit</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取当前区块的 gas limit</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>当前区块的 gas limit</li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="交易api"></a><a href="#交易api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>交易API</h3>
<h4><a class="anchor" aria-hidden="true" id="platon_gas_price"></a><a href="#platon_gas_price" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_gas_price()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">u128 <span class="hljs-title">platon::platon_gas_price</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取交易的 gas price.</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>交易的 gas price</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_gas"></a><a href="#platon_gas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_gas()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">platon_gas</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取交易的 gas 值</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>交易的 gas 值</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_caller_nonce"></a><a href="#platon_caller_nonce" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_caller_nonce</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">platon_caller_nonce</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取交易的 nonce 值</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>交易的 nonce 值</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_call_value"></a><a href="#platon_call_value" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_call_value()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">u128 <span class="hljs-title">platon::platon_call_value</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取当前交易的 value 值。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>当前交易的 value 值</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_caller"></a><a href="#platon_caller" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_caller()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">Address <span class="hljs-title">platon::platon_caller</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取交易的发起者</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>交易发起者地址</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_origin"></a><a href="#platon_origin" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_origin()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">Address <span class="hljs-title">platon::platon_origin</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取交易的原始发起者</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>交易原始发起者的地址</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_address"></a><a href="#platon_address" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_address()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">Address <span class="hljs-title">platon::platon_address</span><span class="hljs-params">()</span>
</span></code></pre>
<p>获取交易的合约地址</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>合约地址</li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="帐户api"></a><a href="#帐户api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>帐户Api</h3>
<h4><a class="anchor" aria-hidden="true" id="make_address-12"></a><a href="#make_address-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>make_address() 1/2</h4>
<pre><code class="hljs css language-cpp">template &lt;size_t M&gt; std::pair&lt;Address, bool&gt; make_address(const char (&amp;str)[M])
</code></pre>
<p>CDT 默认识别的地址是主网地址也就是地址前缀为lat，如果要识别测试网地址前缀为lax，需要定义宏TESTNET，在合约第一行加上#define TESTNET即可。</p>
<p>将C风格字符串转换为地址对象。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>str：</code> C风格字符串</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>返回值为 pair，pair 的 second 表示成功或者失败，first 表示 Address 类型的地址。</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="make_address-22"></a><a href="#make_address-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>make_address() 2/2</h4>
<pre><code class="hljs css language-cpp">std::pair&lt;Address, bool&gt; make_address(const std::string &amp;str_address)
</code></pre>
<p>CDT 默认识别的地址是主网地址也就是地址前缀为lat，如果要识别测试网地址前缀为lax，需要定义宏TESTNET，在合约第一行加上#define TESTNET即可。</p>
<p>将字符串转换为地址对象。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>str：</code> 字符串</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>返回值为 pair，pair 的 second 表示成功或者失败，first 表示 Address 类型的地址</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_balance"></a><a href="#platon_balance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_balance()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">Energon <span class="hljs-title">platon::platon_balance</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Address &amp; addr)</span>
</span></code></pre>
<p>根据地址获取余额。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>地址</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>地址余额</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_transfer"></a><a href="#platon_transfer" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_transfer()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">platon::platon_transfer</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Address &amp;addr, <span class="hljs-keyword">const</span> Energon &amp;amount)</span>
</span></code></pre>
<p>将Energon的金额转移到地址。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
<li><code>amount：</code>Energon的数量</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>如果传输成功则为true，否则为false</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platonenergon-class"></a><a href="#platonenergon-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon::Energon Class</h4>
<p>Energo是货币相关操作类</p>
<ul>
<li><p><strong>公共成员函数</strong></p>
<ul>
<li><p><code>Energon (u128 n)</code>
构造一个新的Energon。</p></li>
<li><p><code>const u128 Get () const</code>
获得一定量的Von。</p></li>
<li><p><code>const bytes Bytes () const</code>
获取值的字节，字节使用大端表示。</p></li>
<li><p><code>Energon &amp; Add (const u128 &amp;v)</code>
添加量的 Von。</p></li>
<li><p><code>Energon &amp; Add (const Energon &amp;rhs)</code>
两个 Energon 对象相加</p></li>
<li><p><code>Energon &amp; operator+= (const Energon &amp;rhs)</code>
实现运算符+ =</p></li>
</ul></li>
<li><p><strong>构造函数和析构函数</strong></p>
<ul>
<li><code>platon::Energon::Energon(u128 n)</code>
构造一个新的Energon。
<ul>
<li><strong>参数</strong>
<ul>
<li><code>n：</code> Von 数量</li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>成员函数功能</strong></p>
<ul>
<li><p><code>Energon&amp; platon::Energon::Add(const Energon &amp; rhs)</code>
添加量的Von。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>rhs：</code>Von的数量</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>Energon的引用</li>
</ul></li>
</ul></li>
<li><p><code>Energon&amp; platon::Energon::Add(const u128 &amp; v)</code>
添加量的Von。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>v：</code>Von的数量</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>Energon的引用</li>
</ul></li>
</ul></li>
<li><p><code>const bytes platon::Energon::Bytes() const</code>
获取值的字节，字节使用大端表示。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>值的字节</li>
</ul></li>
</ul></li>
<li><p><code>const u128 platon::Energon::Get() const</code>
获得一定量的Von。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>Von量</li>
</ul></li>
</ul></li>
<li><p><code>Energon&amp; platon::Energon::operator+= ( const Energon &amp; rhs)</code>
实现运算符+ =</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>rhs：</code>Energon对象</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>Energon的引用</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platonwhitelist-tablename--class"></a><a href="#platonwhitelist-tablename--class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon::WhiteList&lt; TableName &gt; Class</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">template</span>&lt;Name::Raw TableName&gt;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">platon</span>:</span>:WhiteList&lt; TableName &gt;
</code></pre>
<p>持久存储白名单工具。</p>
<ul>
<li><p><strong>模板参数</strong></p>
<ul>
<li><code>Name：</code>白名单名称，在同一合约中，该名称应唯一</li>
</ul></li>
<li><p><strong>构造函数和析构函数</strong></p>
<ul>
<li><p><code>template&lt;Name::Raw TableName&gt; platon::WhiteList&lt; TableName &gt;::WhiteList ()</code></p>
<p>构造一个新的清单。</p></li>
</ul></li>
<li><p><strong>公共成员函数</strong></p>
<ul>
<li><p><code>WhiteList ()</code>
构造一个新的清单。</p></li>
<li><p><code>void Add (const std::string &amp;addr)</code>
将地址添加到白名单。</p></li>
<li><p><code>void Add (const Address &amp;addr)</code>
将地址添加到白名单。</p></li>
<li><p><code>void Delete (const std::string &amp;addr)</code>
从白名单中删除地址。</p></li>
<li><p><code>void Delete (const Address &amp;addr)</code>
从白名单中删除地址。</p></li>
<li><p><code>bool Exists (const std::string &amp;addr)</code>
该地址是否存在于白名单中。</p></li>
<li><p><code>bool Exists (const Address &amp;addr)</code>
该地址是否存在于白名单中。</p></li>
</ul></li>
<li><p><strong>成员函数功能</strong></p>
<ul>
<li><p><code>template&lt;Name::Raw TableName&gt; void platon::WhiteList&lt; TableName &gt;::Add ( const Address &amp; addr)</code>
将地址添加到白名单。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
</ul></li>
</ul></li>
<li><p><code>template&lt;Name::Raw TableName&gt; void platon::WhiteList&lt; TableName &gt;::Add ( const std::string &amp; addr)</code>
将地址添加到白名单。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
</ul></li>
</ul></li>
<li><p><code>template&lt;Name::Raw TableName&gt; void platon::WhiteList&lt; TableName &gt;::Delete ( const Address &amp; addr)</code>
从白名单中删除地址。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
</ul></li>
</ul></li>
<li><p><code>template&lt;Name::Raw TableName&gt; void platon::WhiteList&lt; TableName &gt;::Delete ( const std::string &amp; addr)</code>
从白名单中删除地址。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
</ul></li>
</ul></li>
<li><p><code>template&lt;Name::Raw TableName&gt; bool platon::WhiteList&lt; TableName &gt;::Exists ( const Address &amp; addr)</code>
该地址是否存在于白名单中。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>如果存在则为true，否则为false</li>
</ul></li>
</ul></li>
<li><p><code>template&lt;Name::Raw TableName&gt; bool platon::WhiteList&lt; TableName &gt;::Exists ( const std::string &amp; addr)</code>
该地址是否存在于白名单中。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>帐户地址</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>如果存在则为true，否则为false</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="存储api"></a><a href="#存储api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>存储API</h3>
<h4><a class="anchor" aria-hidden="true" id="platon_set_state"></a><a href="#platon_set_state" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_set_state()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">platon_set_state</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *key, <span class="hljs-keyword">size_t</span> klen, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *value, <span class="hljs-keyword">size_t</span> vlen)</span>
</span></code></pre>
<p>设置状态对象</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>key：</code>键</li>
<li><code>Klen：</code>键的长度</li>
<li><code>value：</code>值</li>
<li><code>vlen：</code>值的长度</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_get_state_length"></a><a href="#platon_get_state_length" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_get_state_length()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">platon_get_state_length</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *key, <span class="hljs-keyword">size_t</span> klen)</span>
</span></code></pre>
<p>获取键对应的值的长度</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>key：</code>键</li>
<li><code>Klen：</code>键的长度</li>
</ul></li>
<li><p><strong>返回值</strong></p>
<ul>
<li>键对应的值的长度</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_get_state"></a><a href="#platon_get_state" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_get_state()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">platon_get_state</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *key, <span class="hljs-keyword">size_t</span> klen, <span class="hljs-keyword">uint8_t</span> *value, <span class="hljs-keyword">size_t</span> vlen)</span></span>;
</code></pre>
<p>获取状态对象</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>key：</code>键</li>
<li><code>Klen：</code>密钥的长度</li>
<li><code>value：</code>值</li>
<li><code>vlen：</code>价值的长度</li>
</ul></li>
<li><p><strong>返回值</strong></p>
<ul>
<li>值的长度</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platonstoragetype-storagename-t--模板类"></a><a href="#platonstoragetype-storagename-t--模板类" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon::StorageType&lt; StorageName, T &gt; 模板类</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">template</span>&lt;Name::Raw StorageName, <span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">platon</span>:</span>:StorageType&lt; StorageName, T &gt;
</code></pre>
<ul>
<li><p><strong>模板参数</strong></p>
<ul>
<li><code>StorageName：</code>元素值名称，在同一合约中，该名称必须唯一</li>
<li><code>T：</code>元素类型</li>
</ul></li>
<li><p><strong>公共成员功能</strong></p>
<ul>
<li><p><code>StorageType ()</code>
构造一个新的存储类型对象</p></li>
<li><p><code>StorageType (const T &amp;d)</code>
构造一个新的存储类型对象</p></li>
<li><p><code>StorageType (const StorageType&lt; StorageName, T &gt; &amp;)=delete</code></p></li>
<li><p><code>StorageType (const StorageType&lt; StorageName, T &gt; &amp;&amp;)=delete</code></p></li>
<li><p><code>~StorageType ()</code>
销毁存储类型对象。刷新到区块链。</p></li>
<li><p><code>T &amp; operator= (const T &amp;t)</code></p></li>
<li><p><code>template&lt;typename P&gt; bool operator== (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; bool operator!= (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; bool operator&lt; (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; bool operator&gt;= (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; bool operator&lt;= (const P &amp;t) const</code></p></li>
<li><p>`template<typename P>
bool operator&gt; (const P &amp;t) const</p></li>
<li><p><code>template&lt;typename P&gt; T &amp; operator^= (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; T operator^ (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; T &amp; operator|= (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; T operator| (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; T &amp; operator&amp;= (const P &amp;t) const</code></p></li>
<li><p><code>template&lt;typename P&gt; T operator&amp; (const P &amp;t) const</code></p></li>
<li><p><code>T operator~ () const</code></p></li>
<li><p><code>T &amp; operator&lt;&lt; (int offset)</code></p></li>
<li><p><code>T &amp; operator&gt;&gt; (int offset)</code></p></li>
<li><p><code>T &amp; operator++ ()</code></p></li>
<li><p><code>T operator++ (int)</code></p></li>
<li><p><code>T &amp; operator[] (int i)</code></p></li>
<li><p><code>template&lt;typename P&gt; T &amp; operator+= (const P &amp;p)</code></p></li>
<li><p><code>template&lt;typename P&gt; T &amp; operator-= (const P &amp;p)</code></p></li>
<li><p><code>T &amp; operator* ()</code></p></li>
<li><p><code>T * operator-&gt; ()</code></p></li>
<li><p><code>operator bool () const</code></p></li>
<li><p><code>T get () const</code></p></li>
<li><p><code>T &amp; self ()</code></p></li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platondbarray-tablename-key-n--模板类"></a><a href="#platondbarray-tablename-key-n--模板类" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon::db::Array&lt; TableName, Key, N &gt; 模板类</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">template</span>&lt;Name::Raw TableName, <span class="hljs-keyword">typename</span> Key, <span class="hljs-keyword">unsigned</span> N&gt;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">platon</span>:</span>:db::Array&lt; TableName, Key, N &gt;
</code></pre>
<ul>
<li><p><strong>成员类</strong></p>
<ul>
<li><p><code>class const_iterator Constant iterator.</code></p></li>
<li><p><code>class const_reverse_iterator Constant reverse iterator.</code></p></li>
<li><p><code>class iterator Iterator.</code></p></li>
</ul></li>
<li><p><strong>Public Types</strong></p>
<ul>
<li><code>typedef std::reverse_iterator&lt; iterator &gt; reverse_iterator</code></li>
</ul></li>
<li><p><strong>公共成员函数</strong></p>
<ul>
<li><p><code>Array ()</code></p></li>
<li><p><code>Array (const Array&lt; TableName, Key, N &gt; &amp;)=delete</code></p></li>
<li><p><code>Array (const Array&lt; TableName, Key, N &gt; &amp;&amp;)=delete</code></p></li>
<li><p><code>Array&lt; TableName, Key, N &gt; &amp; operator= (const Array&lt; TableName, Key, N &gt; &amp;)=delete</code></p></li>
<li><p><code>~Array ()</code></p></li>
<li><p><code>iterator begin ()</code>
迭代器开始位置</p></li>
<li><p><code>iterator end ()</code>
迭代器结束位置</p></li>
<li><p><code>reverse_iterator rbegin ()</code>
反向迭代器开始位置。</p></li>
<li><p><code>reverse_iterator rend ()</code>
反向迭代器结束位置。</p></li>
<li><p><code>const_iterator cbegin ()</code>
常量迭代器开始位置。</p></li>
<li><p><code>const_iterator cend ()</code>
常量迭代器最终位置。</p></li>
<li><p><code>const_reverse_iterator crbegin ()</code>
常数反向迭代器的起始位置。</p></li>
<li><p><code>const_reverse_iterator crend ()</code>
常数反向迭代器的最终位置。</p></li>
<li><p><code>Key &amp; at (size_t pos)</code>
获取指定的position元素。</p></li>
<li><p><code>Key &amp; operator[] (size_t pos)</code>
括号运算符。</p></li>
<li><p><code>size_t size ()</code>
数组大小</p></li>
<li><p><code>Key get_const (size_t pos)</code>
获取Const对象。不要刷新以缓存。</p></li>
<li><p><code>void set_const (size_t pos, const Key &amp;key)</code>
设置Const对象，请勿刷新以缓存。</p></li>
</ul></li>
<li><p><strong>静态公共属性</strong></p>
<ul>
<li><code>static const std::string kType = &quot;__array__&quot;</code></li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platondbmap-tablename-key-value--模板类"></a><a href="#platondbmap-tablename-key-value--模板类" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon::db::Map&lt; TableName, Key, Value &gt; 模板类</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">template</span>&lt;Name::Raw TableName, <span class="hljs-keyword">typename</span> Key, <span class="hljs-keyword">typename</span> Value&gt;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">platon</span>:</span>:db::Map&lt; TableName, Key, Value &gt;
</code></pre>
<p>实现map操作，map模板。</p>
<ul>
<li><p><strong>模板参数</strong></p>
<ul>
<li><code>TableName:</code> map的名称，map的名称在每个合约中应该是唯一的。</li>
<li><code>Key：</code>键类型</li>
<li><code>Value：</code>值类型</li>
</ul>
<p>MapType::Traverse 默认值为Traverse，当Traverse需要额外的数据结构进行操作时，当不需要遍历操作时，将其设置为NoTraverse。</p></li>
<li><p><strong>公共成员函数功能</strong></p>
<ul>
<li><p><code>Map ()</code></p></li>
<li><p><code>Map(const Map&lt; TableName, Key, Value &gt; &amp;)=delete</code></p></li>
<li><p><code>Map(const Map&lt; TableName, Key, Value &gt; &amp;&amp;)=delete</code></p></li>
<li><p><code>Map&lt; TableName, Key, Value &gt; &amp; operator= (const Map&lt; TableName, Key, Value &gt; &amp;)=delete</code></p></li>
<li><p><code>~Map ()</code>
销毁Map对象将数据刷新到区块链。</p></li>
<li><p><code>bool insert (const Key &amp;k, const Value &amp;v)</code>
插入新的键值对，更新为缓存。</p></li>
<li><p><code>bool insert_const (const Key &amp;k, const Value &amp;v)</code>
插入将不会更新到缓存的新键值对。适用于大量插入，插入后无需更新。</p></li>
<li><p><code>Value get_const (const Key &amp;k)</code>
获取Const对象，将不会加入缓存。</p></li>
<li><p><code>Value &amp; at (const Key &amp;k)</code>
获取值，将被添加到缓存中。</p></li>
<li><p><code>void erase (const Key &amp;k)</code>
删除键值对。</p></li>
<li><p><code>Value &amp; operator[] (const Key &amp;k)</code>
括号运算符。</p></li>
<li><p><code>boolcontains (const Key &amp;key)</code>
检查容器中是否存在具有与key等效的键的元素。</p></li>
<li><p><code>void flush ()</code>
将内存中的修改数据刷新到区块链。</p></li>
</ul></li>
<li><p><strong>静态公共属性</strong></p>
<ul>
<li><code>static const std::string kType = &quot;__map__&quot;</code></li>
</ul></li>
<li><p><strong>构造函数和析构函数</strong></p>
<ul>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; platon::db::Map&lt; TableName, Key, Value &gt;::Map ()</code></p></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; platon::db::Map&lt; TableName, Key, Value &gt;::Map (const Map&lt; TableName, Key, Value &gt; &amp; )</code></p></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; platon::db::Map&lt; TableName, Key, Value &gt;::Map (const Map&lt; TableName, Key, Value &gt; &amp;&amp; )</code></p></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; platon::db::Map&lt; TableName, Key, Value &gt;::~Map ()</code></p></li>
</ul></li>
</ul>
<p>销毁Map对象将数据刷新到区块链。</p>
<ul>
<li><p><strong>成员函数功能</strong></p>
<ul>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; Value&amp; platon::db::Map&lt; TableName, Key, Value &gt;::at ( const Key &amp; k )</code>
获取值，将被添加到缓存中。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
</ul></li>
<li><p><strong>返回值</strong></p></li>
<li><p>值的引用</p></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
MapStr <span class="hljs-built_in">map</span>;
<span class="hljs-built_in">map</span>.insert(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>);
</code></pre></li>
</ul>
<p>assert(map.at[&quot;hello&quot;] == &quot;world&quot;);</p>
<pre><code class="hljs">
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; bool platon::db::Map&lt; TableName, Key, Value &gt;::contains ( const Key &amp; key )</code>
检查容器中是否存在具有与key等效的键的元素。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
</ul></li>
<li><p><strong>返回值</strong></p></li>
<li><p>如果存在这样的元素，则为true，否则为false。</p></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"> <span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
 MapStr <span class="hljs-built_in">map</span>;
 <span class="hljs-built_in">map</span>.[<span class="hljs-string">"hello"</span>] = <span class="hljs-string">"world"</span>;
</code></pre></li>
</ul>
<p>assert(map.contains(&quot;hello&quot;));</p>
<pre><code class="hljs">
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; void platon::db::Map&lt; TableName, Key, Value &gt;::erase ( const Key &amp; k )</code>
删除键值对。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
</ul></li>
</ul></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
MapStr <span class="hljs-built_in">map</span>;
<span class="hljs-built_in">map</span>.insert(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>);
<span class="hljs-built_in">map</span>.erase(<span class="hljs-string">"hello"</span>);
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; void platon::db::Map&lt; TableName, Key, Value &gt;::flush ()</code>
将内存中的修改数据刷新到区块链。</p></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; Value platon::db::Map&lt; TableName, Key, Value &gt;::get_const ( const Key &amp; k)</code>
获取Const对象，将不会加入缓存。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
</ul></li>
<li><p><strong>返回值</strong></p></li>
<li><p>价值</p></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
MapStr <span class="hljs-built_in">map</span>;
<span class="hljs-built_in">map</span>.insert(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>);
</code></pre></li>
</ul>
<p>assert(map.get_const[&quot;hello&quot;] == &quot;world&quot;);</p>
<pre><code class="hljs">
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; bool platon::db::Map&lt; TableName, Key, Value &gt;::insert ( const Key &amp; k, const Value &amp; v)</code>
插入新的键值对，更新为缓存。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
<li><code>v：</code>值</li>
</ul></li>
<li><p><strong>返回值</strong></p>
<ul>
<li>true插入成功，false插入失败</li>
</ul></li>
</ul></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
MapStr <span class="hljs-built_in">map</span>;
<span class="hljs-built_in">map</span>.insert(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>);
assert(<span class="hljs-built_in">map</span>[<span class="hljs-string">"hello"</span>] == <span class="hljs-string">"world"</span>);
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; bool platon::db::Map&lt; TableName, Key, Value &gt;::insert_const ( const Key &amp; k, const Value &amp; v)</code>
插入将不会更新到缓存的新键值对。适用于大量插入，插入后无需更新。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
<li><code>v：</code>值</li>
</ul></li>
<li><p><strong>返回值</strong></p>
<ul>
<li>true插入成功，false插入失败</li>
</ul></li>
</ul></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
MapStr <span class="hljs-built_in">map</span>;
<span class="hljs-built_in">map</span>.insert_const(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>);
assert(<span class="hljs-built_in">map</span>[<span class="hljs-string">"hello"</span>] == <span class="hljs-string">"world"</span>);
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; Map&lt;TableName, Key, Value&gt;&amp; platon::db::Map&lt; TableName, Key, Value &gt;::operator= ( const Map&lt; TableName, Key, Value &gt; &amp; )</code></p></li>
<li><p><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; Value&amp; platon::db::Map&lt; TableName, Key, Value &gt;::operator[] ( const Key &amp; k)</code>
括号运算符。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>k：</code>键</li>
</ul></li>
<li><p><strong>返回值</strong></p></li>
<li><p>价值与获取价值</p></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">typedef</span> platon::db::Map&lt;<span class="hljs-string">"map_str"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; MapStr;
MapStr <span class="hljs-built_in">map</span>;
<span class="hljs-built_in">map</span>.[<span class="hljs-string">"hello"</span>] = <span class="hljs-string">"world"</span>;
</code></pre></li>
</ul></li>
</ul></li>
<li><p><strong>成员变量</strong></p>
<ul>
<li><code>template&lt;Name::Raw TableName, typename Key , typename Value &gt; const std::string platon::db::Map&lt; TableName, Key, Value &gt;::kType = &quot;__map__&quot;</code></li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="templatenameraw-tablename-typename-t-typename-indices-class-platondbmultiindex-tablename-t-indices-"></a><a href="#templatenameraw-tablename-typename-t-typename-indices-class-platondbmultiindex-tablename-t-indices-" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>template&lt;Name::Raw TableName, typename T, typename... Indices&gt; class platon::db::MultiIndex&lt; TableName, T, Indices &gt;</h4>
<p>MultiIndex支持惟一索引和普通索引。惟一索引应该放在参数的第一个位置。结构需要提供与index字段对应的get函数。</p>
<ul>
<li><strong>成员函数功能</strong>
<ul>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt;const_iterator platon::db::MultiIndex&lt; TableName, T, Indices &gt;::cbegin()</code>
开始迭代器</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>const_iterator</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp">  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
  <span class="hljs-keyword">uint8_t</span> age;
  <span class="hljs-keyword">uint8_t</span> sex;
  <span class="hljs-keyword">uint64_t</span> $seq_;
  <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
  <span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
  PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
  <span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                      IndexType::UniqueIndex&gt;&gt;,
  IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
  member_table;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = member_table.cbegin(); it != it_end; ++it){}
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; const_iterator platon::db::MultiIndex&lt; TableName, T, Indices &gt;::cend()</code>
结束迭代器</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>const_iterator</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp">  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
  <span class="hljs-keyword">uint8_t</span> age;
  <span class="hljs-keyword">uint8_t</span> sex;
  <span class="hljs-keyword">uint64_t</span> $seq_;
  <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
  <span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
  PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
  <span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                      IndexType::UniqueIndex&gt;&gt;,
  IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
  member_table;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = member_table.cbegin(); it != it_end; ++it){}
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; template&lt;Name::Raw IndexName, typename KEY &gt; size_t platon::db::MultiIndex&lt; TableName, T, Indices &gt;::count(const KEY &amp;key)</code></p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>获取与索引值对应的数据的数量</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
<span class="hljs-keyword">uint8_t</span> age;
<span class="hljs-keyword">uint8_t</span> sex;
<span class="hljs-keyword">uint64_t</span> $seq_;
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
<span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
<span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                    IndexType::UniqueIndex&gt;&gt;,
IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
member_table;
<span class="hljs-keyword">auto</span> count = member_table.count&lt;<span class="hljs-string">"index2"</span>_n&gt;(<span class="hljs-keyword">uint8_t</span>(<span class="hljs-number">10</span>));
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; template&lt;typename Lambda&gt; std::pair&lt;const_iterator, bool&gt; platon::db::MultiIndex&lt; TableName, T, Indices &gt;::emplace(Lambda &amp;constructor)</code></p>
<ul>
<li><strong>参数</strong>
<ul>
<li>数据项处理函数</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>返回一个迭代器，该迭代器指示使用bool类型的插入是否成功。如果惟一索引冲突，则插入失败</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
  <span class="hljs-keyword">uint8_t</span> age;
  <span class="hljs-keyword">uint8_t</span> sex;
  <span class="hljs-keyword">uint64_t</span> $seq_;
  <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
  <span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
  PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
  <span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                      IndexType::UniqueIndex&gt;&gt;,
  IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
  member_table;
member_table.emplace([&amp;](<span class="hljs-keyword">auto</span> &amp;m) {
  m.age = <span class="hljs-number">10</span>;
  m.name = <span class="hljs-string">"hello"</span>;
  m.sex = <span class="hljs-number">1</span>;
});
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; void platon::db::MultiIndex&lt; TableName, T, Indices &gt;::erase(const_iterator position)</code>
基于迭代器删除数据</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>position：</code>迭代器</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
<span class="hljs-keyword">uint8_t</span> age;
<span class="hljs-keyword">uint8_t</span> sex;
<span class="hljs-keyword">uint64_t</span> $seq_;
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
<span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
<span class="hljs-string">"table"</span>_n, Member,
IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                  IndexType::UniqueIndex&gt;&gt;,
IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                    IndexType::NormalIndex&gt;&gt;&gt;
member_table;
<span class="hljs-keyword">auto</span> vect_iter = member_table.find&lt;<span class="hljs-string">"index2"</span>_n&gt;(<span class="hljs-keyword">uint8_t</span>(<span class="hljs-number">10</span>));
member_table.erase(vect_iter[<span class="hljs-number">0</span>]);
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; template&lt;Name::Raw IndexName, typename KEY &gt; const_iterator platon::db::MultiIndex&lt; TableName, T, Indices &gt;::find(const KEY &amp; key)</code>
找到数据，只有一个唯一的索引是可用的。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>key：</code>索引值</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>结果迭代器。如果没有找到值为cend()。</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
<span class="hljs-keyword">uint8_t</span> age;
<span class="hljs-keyword">uint8_t</span> sex;
<span class="hljs-keyword">uint64_t</span> $seq_;
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
<span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
<span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                    IndexType::UniqueIndex&gt;&gt;,
IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
member_table;
<span class="hljs-keyword">auto</span> vect_iter = member_table.find&lt;<span class="hljs-string">"index2"</span>_n&gt;(<span class="hljs-keyword">uint8_t</span>(<span class="hljs-number">10</span>));
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; template&lt;Name::Raw IndexName&gt;auto platon::db::MultiIndex&lt; TableName, T, Indices &gt;::get_index()</code>
获取非唯一索引的索引对象。</p>
<ul>
<li><strong>返回值</strong>
<ul>
<li>索引对象</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
<span class="hljs-keyword">uint8_t</span> age;
<span class="hljs-keyword">uint8_t</span> sex;
<span class="hljs-keyword">uint64_t</span> $seq_;
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
<span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
<span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                    IndexType::UniqueIndex&gt;&gt;,
IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
member_table;
<span class="hljs-keyword">auto</span> index = member_table.get_index&lt;<span class="hljs-string">"index2"</span>_n&gt;();
</code></pre></li>
<li><p><code>template&lt;Name::Raw TableName, typename T , typename... Indices&gt; template&lt;typename Lambda &gt;void platon::db::MultiIndex&lt; TableName, T, Indices &gt;::modify(const_iterator position,Lambda &amp;&amp; constructor)</code>
基于迭代器修改数据，但不能修改所有与索引相关的字段。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>position：</code>迭代器</li>
<li><code>constructor：</code>更新目标对象的lambda函数</li>
</ul></li>
<li><strong>示例：</strong></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Member</span> {</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name;
<span class="hljs-keyword">uint8_t</span> age;
<span class="hljs-keyword">uint8_t</span> sex;
<span class="hljs-keyword">uint64_t</span> $seq_;
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">Name</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> name; }
<span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">Age</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> age; }
PLATON_SERIALIZE(Member, (name)(age)(sex))
};
MultiIndex&lt;
<span class="hljs-string">"table"</span>_n, Member,
  IndexedBy&lt;<span class="hljs-string">"index"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, &amp;Member::Name,
                                    IndexType::UniqueIndex&gt;&gt;,
IndexedBy&lt;<span class="hljs-string">"index2"</span>_n, IndexMemberFun&lt;Member, <span class="hljs-keyword">uint8_t</span>, &amp;Member::Age,
                                      IndexType::NormalIndex&gt;&gt;&gt;
member_table;
member_table.modify(r.first, [&amp;](<span class="hljs-keyword">auto</span> &amp;m) { m.sex = <span class="hljs-number">15</span>; });
</code></pre></li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="合约api"></a><a href="#合约api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合约API</h3>
<h4><a class="anchor" aria-hidden="true" id="platon_destroy"></a><a href="#platon_destroy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_destroy()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">platon::platon_destroy</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> Address &amp; addr)</span>
</span></code></pre>
<p>销毁合约。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>合约地址</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>如果销毁成功，则为true，否则为false</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_migrate_contract"></a><a href="#platon_migrate_contract" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_migrate_contract()</h4>
<pre><code class="hljs css language-cpp">template&lt;typename value_type , typename gas_type &gt;
bool platon::platon_migrate_contract ( Address &amp; addr,
const bytes &amp; init_args,
value_type  value,
gas_type  gas)
</code></pre>
<p>迁移合约。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>新合约的地址</li>
<li><code>init_args：</code>输入参数</li>
<li><code>value：</code>转账金额</li>
<li><code>gas：</code>支付此交易的gas金额</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>如果迁移成功，则为true，否则为false</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="cross_call_args"></a><a href="#cross_call_args" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cross_call_args()</h4>
<pre><code class="hljs css language-cpp">template&lt;typename... Args&gt;
bytes platon::cross_call_args ( const std::string &amp; method,
const Args &amp;...  args)  
</code></pre>
<p>构造跨合约调用参数。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>method：</code>被调用合约的方法名称</li>
<li><code>args：</code>对应于合约方法的参数</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>参数字节数组</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_call-12"></a><a href="#platon_call-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_call() 1/2</h4>
<pre><code class="hljs css language-cpp">template&lt;typename value_type , typename gas_type &gt;
bool platon::platon_call ( const Address &amp; addr,
const bytes &amp; paras,
const value_type &amp; value,
const gas_type &amp; gas)  
</code></pre>
<p>正常的跨合约调用。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>要调用的合约地址</li>
<li><code>paras：</code>使用函数cross_call_args构造的合约参数</li>
<li><code>gas：</code>对应的合约方法估计消耗的gas</li>
<li><code>value：</code>转移到合约的金额</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>调用成功或失败</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_call-22"></a><a href="#platon_call-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_call() 2/2</h4>
<pre><code class="hljs css language-cpp">template&lt;typename return_type , typename value_type , typename gas_type , typename... Args&gt;
decltype(auto) platon::platon_call ( const Address &amp; addr,
const value_type &amp; value,
const gas_type &amp; gas,
const std::string &amp; method,
const Args &amp;...  args
)
</code></pre>
<p>正常的跨合约调用。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>addr：</code>要调用的合约地址</li>
<li><code>value：</code>转移到合约的金额</li>
<li><code>gas：</code>对应的合约方法估计消耗的gas</li>
<li><code>method：</code>被调用合约的方法名称</li>
<li><code>args：</code>对应于合约方法的参数</li>
</ul></li>
<li><p><strong>返回值</strong></p>
<ul>
<li>合约方法* <strong>返回值</strong>值以及执行是否成功</li>
</ul></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">auto</span> result =
platon_call&lt;<span class="hljs-keyword">int</span>&gt;(Address(<span class="hljs-string">"0xEC081ab45BE978A4A630eB8cbcBffA50E747971B"</span>),
<span class="hljs-keyword">uint32_t</span>(<span class="hljs-number">100</span>), <span class="hljs-keyword">uint32_t</span>(<span class="hljs-number">100</span>), <span class="hljs-string">"add"</span>, <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);
<span class="hljs-keyword">if</span>(!result.secod){
  platon_throw(<span class="hljs-string">"cross call fail"</span>);
}
</code></pre></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_delegate_call-12"></a><a href="#platon_delegate_call-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_delegate_call() 1/2</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> gas_type &gt;
<span class="hljs-keyword">bool</span> <span class="hljs-title">platon::platon_delegate_call</span> <span class="hljs-params">( <span class="hljs-keyword">const</span> Address &amp; addr,
<span class="hljs-keyword">const</span> bytes &amp; paras,
<span class="hljs-keyword">const</span> gas_type &amp; gas
)</span>  
</span></code></pre>
<p>跨合约代理调用。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>addr：</code>要调用的合约地址</li>
<li><code>paras：</code>使用函数cross_call_args构造的合约参数</li>
<li><code>gas：</code>对应的合约方法估计消耗的gas</li>
</ul></li>
<li><strong>返回值</strong>
<ul>
<li>调用成功或失败</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_delegate_call-22"></a><a href="#platon_delegate_call-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_delegate_call() 2/2</h4>
<pre><code class="hljs css language-cpp">template&lt;typename return_type , typename gas_type , typename... Args&gt;
decltype(auto) platon::platon_delegate_call ( const Address &amp; addr,
const gas_type &amp; gas,
const std::string &amp; method,
const Args &amp;...  args)  
</code></pre>
<p>跨合约代理调用。</p>
<ul>
<li><p><strong>参数</strong></p>
<ul>
<li><code>addr：</code>要调用的合约地址</li>
<li><code>gas：</code>对应的合约方法估计消耗的gas</li>
<li><code>method：</code>被调用合约的方法名称</li>
<li><code>args：</code>对应于合约方法的参数</li>
</ul></li>
<li><p><strong>返回值</strong></p>
<ul>
<li>合约方法* <strong>返回值</strong>值以及执行是否成功</li>
</ul></li>
<li><p><strong>示例：</strong></p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">auto</span> result =
platon_delegate_call&lt;<span class="hljs-keyword">int</span>&gt;(Address(<span class="hljs-string">"0xEC081ab45BE978A4A630eB8cbcBffA50E747971B"</span>),
 <span class="hljs-keyword">uint32_t</span>(<span class="hljs-number">100</span>), <span class="hljs-string">"add"</span>, <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);
 <span class="hljs-keyword">if</span>(!result.secod){
   platon_throw(<span class="hljs-string">"cross call fail"</span>);
 }
</code></pre></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="get_call_output"></a><a href="#get_call_output" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>get_call_output()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T &gt;
<span class="hljs-keyword">void</span> <span class="hljs-title">platon::get_call_output</span> <span class="hljs-params">( T &amp; t)</span>
</span></code></pre>
<p>获取跨合约调用合约方法的返回值。</p>
<ul>
<li><strong>模板参数</strong>
<ul>
<li><code>T：</code>输出值类型</li>
</ul></li>
<li><strong>参数</strong>
<ul>
<li><code>t：</code>合约方法返回的值</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="platon_event"></a><a href="#platon_event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_event</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">platon_event</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *topic, <span class="hljs-keyword">size_t</span> topic_len, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *args,
                  <span class="hljs-keyword">size_t</span> args_len)</span></span>;
</code></pre>
<p>发布事件</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>topic：</code>事件的主题</li>
<li><code>topic_len：</code>主题的长度</li>
<li><code>args：</code>参数</li>
<li><code>args_len：</code>参数的长度</li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="异常api"></a><a href="#异常api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异常API</h3>
<h4><a class="anchor" aria-hidden="true" id="platon_panic"></a><a href="#platon_panic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_panic</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">platon_panic</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;
</code></pre>
<p>终止交易，扣除交易的所有gas</p>
<h4><a class="anchor" aria-hidden="true" id="platon_revert"></a><a href="#platon_revert" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_revert</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">platon_revert</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;
</code></pre>
<p>终止交易并扣除消耗的gas</p>
<h3><a class="anchor" aria-hidden="true" id="其他api"></a><a href="#其他api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他API</h3>
<h4><a class="anchor" aria-hidden="true" id="platon_sha3"></a><a href="#platon_sha3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>platon_sha3()</h4>
<pre><code class="hljs css language-cpp"><span class="hljs-function">h256 <span class="hljs-title">platon::platon_sha3</span> <span class="hljs-params">( <span class="hljs-keyword">const</span> bytes &amp; data )</span>
</span></code></pre>
<p>Sh3算法。</p>
<ul>
<li><strong>参数</strong>
<ul>
<li><code>data：</code>二进制数据</li>
</ul></li>
<li><strong>返回</strong>
<ul>
<li>数据哈希</li>
</ul></li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="faq"></a><a href="#faq" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FAQ</h2>
<h3><a class="anchor" aria-hidden="true" id="编译相关"></a><a href="#编译相关" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>编译相关</h3>
<ol>
<li><p>使用 <code>platon-cpp</code> 如何编译多个 <code>cpp</code> 文件?</p>
<pre><code class="hljs css language-shell">platon-cpp ./test.cpp ./test1.cpp
</code></pre>
<p>只允许存在一个合约类。</p></li>
<li><p>使用 <code>platon-cpp</code> 编译合约, 如何指定wasm输出目录及文件名?</p>
<p>使用 <code>-o</code> 参数, 且指定目录时必须同时指定文件名:</p>
<pre><code class="hljs css language-shell">platon-cpp ./test.cpp -o ./out/test.wasm
</code></pre></li>
<li><p>platon-truffle执行truffle deploy部署合约失败？</p></li>
</ol>
<p>确认truffle-config.js中连接的链的配置信息及用户的钱包地址是否正确,钱包是否解锁。</p>
<ol start="4">
<li>truffle 部署带参数的构造函数合约失败？</li>
</ol>
<p>如果合约中的init函数带有参数，部署合约时需要指定params参数。</p>
<ol start="5">
<li><p>ABI 支持哪些数据类型?</p>
<p>生成ABI支持的类型和转换规则如下：</p></li>
</ol>
<table>
<thead>
<tr><th>类型</th><th>ABI</th></tr>
</thead>
<tbody>
<tr><td>bool</td><td>bool</td></tr>
<tr><td>uint8_t</td><td>uint8</td></tr>
<tr><td>uint16_t</td><td>uint16</td></tr>
<tr><td>uint32_t</td><td>uint32</td></tr>
<tr><td>uint64_t</td><td>uint64</td></tr>
<tr><td>int8_t</td><td>int8</td></tr>
<tr><td>int16_t</td><td>int16</td></tr>
<tr><td>int32_t</td><td>int32</td></tr>
<tr><td>int64_t</td><td>int64</td></tr>
<tr><td>bytes</td><td>uint8[]</td></tr>
<tr><td>std::string</td><td>string</td></tr>
<tr><td>std::vector<T></td><td>T[]</td></tr>
<tr><td>std::array[T, N]</td><td>T[N]</td></tr>
<tr><td>std::pair&lt;T, U&gt;</td><td>pair&lt;T, U</td></tr>
<tr><td>std::set<T></td><td>set<T></td></tr>
<tr><td>std::map&lt;T, V&gt;</td><td>map&lt;T, V&gt;</td></tr>
<tr><td>std::list<T></td><td>list<T></td></tr>
<tr><td>FixedHash<N></td><td>FixedHash<N></td></tr>
<tr><td>u128</td><td>uint128</td></tr>
<tr><td>bigint</td><td>uint128</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="合约相关"></a><a href="#合约相关" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合约相关</h3>
<ol>
<li>如何实现在 <code>platon</code> 进程输出合约 debug 日志？</li>
</ol>
<ul>
<li>合约代码首行加上 <code>#undef NDEBUG</code>, 必须在头文件 include 之前</li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> NDEBUG</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;platon/platon.hpp&gt;</span></span>

<span class="hljs-comment">//...</span>
</code></pre>
<ul>
<li><code>platon</code> 启动命令指定日志级别4, 打开 <code>debug</code> 标志</li>
</ul>
<pre><code class="hljs css language-shell">./platon --debug --verbosity 4 ...
</code></pre>
<ol start="2">
<li><p>如何编写合约能有效减少 Gas 消耗？</p>
<ul>
<li>使用引用参数</li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; str)</span> </span>{
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<ul>
<li>返回右值引用</li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;&amp;&amp; <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; v;
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::move(v);
}
</code></pre>
<ul>
<li>尽量不要申请大块内存</li>
</ul></li>
<li><p>使用 <code>StorageType</code> 有哪些地方要注意的？</p>
<ul>
<li>应该在 <code>init()</code> 初始化</li>
</ul>
<pre><code class="hljs css language-cpp">CONTRAT Hello : <span class="hljs-keyword">public</span> Contract {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">ACTION <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>{
        s_.self() = <span class="hljs-string">"test"</span>;
    }
<span class="hljs-keyword">private</span>:
    StorageType&lt;<span class="hljs-string">"test"</span>_n, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; s_;
};
</code></pre>
<ul>
<li><p>建议直接使用 <code>StorageType</code> 的特化类型</p>
<ul>
<li>Uint8</li>
<li>Int8</li>
<li>Uint16</li>
<li>Int16</li>
<li>Uint</li>
<li>Int</li>
<li>Uint64</li>
<li>Int64</li>
<li>String</li>
<li>Vector</li>
<li>Set</li>
<li>Map</li>
<li>Array</li>
<li>Tuple</li>
</ul></li>
</ul></li>
<li><p><code>StorageType</code> 与 <code>platon::db::Map</code>, <code>platon::db::Array</code> 有什么区别?</p>
<p>从底层存储层面来说, <code>StorageType</code> 的实现是作为一个整体序列化, 然后存储到数据
库. 而 <code>platon::db::Map</code> 和 <code>platon::db::Array</code> 则将容器的每一个元素序列化后, 作为
K/V 存储到数据库. 对于大规模数据, <code>platon::db::Map</code> 和 <code>platon::db::Array</code> 性能
更好.</p>
<p>在实现合约时, 应根据数据规模, 选择合适的存储结构.</p></li>
<li><p>RLP 序列化/反序列化 支持哪些 C++ 标准库类型？</p>
<p>支持以下 C++ 标准库类型:</p>
<ul>
<li>std::string</li>
<li>std::vector</li>
<li>std::map</li>
<li>std::list</li>
<li>std::array</li>
<li>std::set</li>
<li>std::pair</li>
<li>std::tuple</li>
</ul></li>
<li><p>自定义类型如何支持 RLP 序列化/反序列化?</p>
<ul>
<li>普通类型使用宏 <code>PLATON_SERIALIZE</code></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Base</span> {</span>
    <span class="hljs-keyword">int</span> a;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> b;

    PLATON_SERIALIZE(Base, (a)(b));
};
</code></pre>
<ul>
<li>派生类使用宏 <code>PLATON_SERIALIZE_DERIVED</code>, 同时基类也要使用宏 <code>PLATON_SERIALIZE</code></li>
</ul>
<pre><code class="hljs css language-cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Derived</span> :</span> <span class="hljs-keyword">public</span> Base {
    <span class="hljs-keyword">int</span> c;
    <span class="hljs-keyword">int</span> d;

    PLATON_SERIALIZE_DERIVED(Derived, Base, (c)(d));
};
</code></pre></li>
</ol>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/zh-CN/EVM_Smart_Contract"><span class="arrow-prev">← </span><span>EVM智能合约</span></a><a class="docs-next button" href="/docs/zh-CN/Python_SDK"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#入门">入门</a><ul class="toc-headings"><li><a href="#概要">概要</a></li><li><a href="#platon-truffle开发工具介绍">platon-truffle开发工具介绍</a></li><li><a href="#创建helloworld合约">创建HelloWorld合约</a></li><li><a href="#编译helloworld合约">编译HelloWorld合约</a></li><li><a href="#部署helloworld合约">部署HelloWorld合约</a></li><li><a href="#调用helloworld合约">调用HelloWorld合约</a></li></ul></li><li><a href="#合约开发成本">合约开发成本</a><ul class="toc-headings"><li><a href="#概要-1">概要</a></li><li><a href="#小型合约示例">小型合约示例</a></li><li><a href="#中型合约示例">中型合约示例</a></li><li><a href="#大型合约示例">大型合约示例</a></li></ul></li><li><a href="#最佳实践">最佳实践</a><ul class="toc-headings"><li><a href="#介绍">介绍</a></li><li><a href="#费用合理设置">费用合理设置</a></li><li><a href="#避免超时">避免超时</a></li><li><a href="#非法操作处罚">非法操作处罚</a></li><li><a href="#cc语言限制">C/C++语言限制</a></li><li><a href="#编程规范">编程规范</a></li></ul></li><li><a href="#api">API</a><ul class="toc-headings"><li><a href="#区块api">区块Api</a></li><li><a href="#交易api">交易API</a></li><li><a href="#帐户api">帐户Api</a></li><li><a href="#存储api">存储API</a></li><li><a href="#合约api">合约API</a></li><li><a href="#异常api">异常API</a></li><li><a href="#其他api">其他API</a></li></ul></li><li><a href="#faq">FAQ</a><ul class="toc-headings"><li><a href="#编译相关">编译相关</a></li><li><a href="#合约相关">合约相关</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.platon.network/" class="nav-home"><img src="/docs/img/PlatON-logo2.svg" alt="PlatON" width="66" height="58"/></a><div><a href="https://www.platon.network/">PlatON network</a><a href="https://latticex.foundation/home">Lattice.Foundation</a><a href="https://forum.latticex.foundation/">Forum</a></div><div class="gitstar"><a class="github-button" href="https://github.com/PlatONnetwork/PlatON-Go" data-color-scheme="no-preference: light; light: light; dark: light;" data-icon="octicon-star" data-size="small" data-show-count="true" aria-label="Star PlatONnetwork/PlatON-Go on GitHub">Star</a></div></section><section class="copyright">COPYRIGHT  © 2021 PLATON NETWORK.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'c2ce4863993980eb049b661be250c773',
                indexName: 'platon',
                inputSelector: '#search_input_react',
                algoliaOptions: {"hitsPerPage":10}
              });
            </script></body></html>